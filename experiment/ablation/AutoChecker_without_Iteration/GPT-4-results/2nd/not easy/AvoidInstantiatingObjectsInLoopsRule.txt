开始

========================================== Rule AvoidInstantiatingObjectsInLoopsRule ===========================================
一共 23 个测试用例
正例 14 个
反例 9 个
27
17
92
78
157
137
107
91
9
7
12
10
12
10
149
133
144
127
9
7
96
79
85
71
10
8
12
9
11
8
85
71
38
34
12
10
83
69
90
76
23
19
40
37
106
91
82
68
116
101
30
28
11
9
15
13
19
14
94
78
97
81
97
91
=========================logics=========================
1. Get the body of the loop statement.
2. Check whether the body contains a constructor call.
3. Get the object created by the constructor call.
4. Check whether the object is of a new type.

If the loop body contains a constructor call that creates a new object, then this test case violates the rule.
*Get the body of the loop statement.* 匹配到的元操作或API：
query: Get the body of the loop statement.
most similar API: get body of for statement: Returns the statement that represents the body of this loop.
cosine Similarity: 0.9237593412399292
*Check whether the body contains a constructor call.* 匹配到的元操作或API：
query: Check whether the body contains a constructor call.
most similar API: Check whether the constructor call equals
cosine Similarity: 0.8527532815933228
*Get the object created by the constructor call.* 匹配到的元操作或API：
logic: Get the object created by the constructor call.
most similar meta operation: Get the type of object created by constructor call
cosine Similarity: 0.8730127811431885
*Check whether the object is of a new type.* 匹配到的元操作或API：
未匹配成功元操作或API
79
65
107
91
=========================logics=========================
1. Check if there's a loop statement.
2. Within the loop statement, check for object creation expressions.
3. Get the type of object created by constructor call.
If within a loop statement there's an object creation expression, then the test case violates the rule.
*Check if there's a loop statement.* 匹配到的元操作或API：
query: Check if there's a loop statement.
most similar API: Check whether the while statement equals
cosine Similarity: 0.807306706905365
*Within the loop statement, check for object creation expressions.* 匹配到的元操作或API：
未匹配成功元操作或API
*Get the type of object created by constructor call.* 匹配到的元操作或API：
logic: Get the type of object created by constructor call.
most similar meta operation: Get the type of object created by constructor call
cosine Similarity: 0.9878885746002197
80
65
=========================logics=========================
1. Get the body of the loop statement.
2. Check whether the body contains a constructor call.
3. Get the type of the object created by the constructor call.
If the body of the loop statement contains a constructor call, then this test case violates the rule.
*Get the body of the loop statement.* 匹配到的元操作或API：
query: Get the body of the loop statement.
most similar API: get body of do statement
cosine Similarity: 0.8413425087928772
*Check whether the body contains a constructor call.* 匹配到的元操作或API：
query: Check whether the body contains a constructor call.
most similar API: Check whether the constructor call equals
cosine Similarity: 0.8527532815933228
*Get the type of the object created by the constructor call.* 匹配到的元操作或API：
logic: Get the type of the object created by the constructor call.
most similar meta operation: Get the type of object created by constructor call
cosine Similarity: 0.9769417643547058
=========================logics=========================
1. Get the body of the do-while loop.
2. Check whether the body of the loop contains a constructor call.
3. Check whether new objects are created in the constructor call.
If new objects are created within the body of the do-while loop, then this test case violates the rule.
*Get the body of the do-while loop.* 匹配到的元操作或API：
query: Get the body of the do-while loop.
most similar API: get body of do statement
cosine Similarity: 0.865790843963623
*Check whether the body of the loop contains a constructor call.* 匹配到的元操作或API：
query: Check whether the body of the loop contains a constructor call.
most similar API: Check whether the constructor call equals
cosine Similarity: 0.8666519522666931
*Check whether new objects are created in the constructor call.* 匹配到的元操作或API：
query: Check whether new objects are created in the constructor call.
most similar API: Check whether the constructor call is qualified instance creation
cosine Similarity: 0.8583307266235352
77
63
=========================logics=========================
1. Get the body of the loop statement.
2. Check whether the body of the loop contains a constructor call to create a new object.
3. Check whether the new object created is thrown as an exception.
If a new object is created within the loop and is not thrown as an exception, this test case violates the rule.
*Get the body of the loop statement.* 匹配到的元操作或API：
query: Get the body of the loop statement.
most similar API: get body of for statement: Returns the statement that represents the body of this loop.
cosine Similarity: 0.9237593412399292
*Check whether the body of the loop contains a constructor call to create a new object.* 匹配到的元操作或API：
query: Check whether the body of the loop contains a constructor call to create a new object.
most similar API: Check whether the constructor call equals
cosine Similarity: 0.8479092121124268
*Check whether the new object created is thrown as an exception.* 匹配到的元操作或API：
未匹配成功元操作或API
77
63
=========================logics=========================
1. Get the loop statement.
2. Get the body of loop statement.
3. Check whether the body of loop statement creates new objects.
4. Check whether the new object is returned immediately in the loop.
If the loop body creates a new object but doesn't return it immediately, then this test case would violate the rule. However, in this case, the new object is returned immediately in the loop, so the test case does not violate the rule.
*Get the loop statement.* 匹配到的元操作或API：
query: Get the loop statement.
most similar API: get body of for statement: Returns the statement that represents the body of this loop.
cosine Similarity: 0.8175114989280701
*Get the body of loop statement.* 匹配到的元操作或API：
query: Get the body of loop statement.
most similar API: get body of for statement: Returns the statement that represents the body of this loop.
cosine Similarity: 0.9263396263122559
*Check whether the body of loop statement creates new objects.* 匹配到的元操作或API：
未匹配成功元操作或API
*Check whether the new object is returned immediately in the loop.* 匹配到的元操作或API：
未匹配成功元操作或API
79
65
116
101
93
78
77
63
85
71
79
65
97
80
=========================logics=========================
1. Get all loop statements in the method.
2. For each loop, get all statements inside the loop.
3. Check whether any statement is a constructor call.
4. Get the object created by the constructor call.
If a statement inside the loop is a constructor call, which means a new object is created, then this test case violates the rule.
*Get all loop statements in the method.* 匹配到的元操作或API：
未匹配成功元操作或API
*For each loop, get all statements inside the loop.* 匹配到的元操作或API：
未匹配成功元操作或API
*Check whether any statement is a constructor call.* 匹配到的元操作或API：
query: Check whether any statement is a constructor call.
most similar API: Check whether the constructor call equals
cosine Similarity: 0.8673230409622192
*Get the object created by the constructor call.* 匹配到的元操作或API：
logic: Get the object created by the constructor call.
most similar meta operation: Get the type of object created by constructor call
cosine Similarity: 0.8730127811431885
96
81
87
72
94
78
82
68
95
78
119
103
96
80
84
70
96
79
114
98
=========================logics=========================
1. Get all loop statements in the class.
2. For each loop, get the loop variable.
3. Check whether the loop variable is of type 'new object'.
4. If it is, then there is a violation of the rule. If not, proceed to the next loop.
5. Repeat until all loops have been checked.
6. If no violations were found in any of the loops, then the test case adheres to the rule.
*Get all loop statements in the class.* 匹配到的元操作或API：
未匹配成功元操作或API
*For each loop, get the loop variable.* 匹配到的元操作或API：
logic: For each loop, get the loop variable.
most similar meta operation: Get the loop variable of for-each loop
cosine Similarity: 0.9562435150146484
*Check whether the loop variable is of type 'new object'.* 匹配到的元操作或API：
未匹配成功元操作或API
*If it is, then there is a violation of the rule. If not, proceed to the next loop.* 匹配到的元操作或API：
未匹配成功元操作或API
*Repeat until all loops have been checked.* 匹配到的元操作或API：
未匹配成功元操作或API
*If no violations were found in any of the loops, then the test case adheres to the rule.* 匹配到的元操作或API：
未匹配成功元操作或API
77
63
94
78
100
82
97
81
77
63
88
73
111
94
94
79
99
82
93
78
94
79
=========================logics=========================
1. Get the body of the for loop.
2. Check whether there is any object creation within the loop.
3. Get the object created by constructor call.
4. Check whether the parameters of the constructor call are different for each iteration.
5. Check whether the created object is assigned to an array element.
If there is an object creation within the loop, and the parameters of the constructor call are different for each iteration or the created object is assigned to an array element, then the test case does not violate the rule.
*Get the body of the for loop.* 匹配到的元操作或API：
query: Get the body of the for loop.
most similar API: get body of for statement
cosine Similarity: 0.9058630466461182
*Check whether there is any object creation within the loop.* 匹配到的元操作或API：
未匹配成功元操作或API
*Get the object created by constructor call.* 匹配到的元操作或API：
logic: Get the object created by constructor call.
most similar meta operation: Get the type of object created by constructor call
cosine Similarity: 0.8863864541053772
*Check whether the parameters of the constructor call are different for each iteration.* 匹配到的元操作或API：
query: Check whether the parameters of the constructor call are different for each iteration.
most similar API: Check whether the constructor call equals
cosine Similarity: 0.830857515335083
*Check whether the created object is assigned to an array element.* 匹配到的元操作或API：
未匹配成功元操作或API
=========================logics=========================
1. Get the block of loop statement.
2. Check whether the block contains object creation expression.
3. Get the type of object created by constructor call.
If the loop block includes an object creation expression, then this test case violates the rule.
*Get the block of loop statement.* 匹配到的元操作或API：
未匹配成功元操作或API
*Check whether the block contains object creation expression.* 匹配到的元操作或API：
query: Check whether the block contains object creation expression.
most similar API: Check whether the constructor call is expression
cosine Similarity: 0.8150137662887573
*Get the type of object created by constructor call.* 匹配到的元操作或API：
logic: Get the type of object created by constructor call.
most similar meta operation: Get the type of object created by constructor call
cosine Similarity: 0.9878885746002197
117
102
125
108
84
69
=========================logics=========================
1. Get the loop variable of for-each loop.
2. Get the body of the for-each loop.
3. Check whether the body contains a constructor call.
4. Get the type of object created by the constructor call.
If the body of the for-each loop contains a constructor call, then this test case violates the rule.
*Get the loop variable of for-each loop.* 匹配到的元操作或API：
logic: Get the loop variable of for-each loop.
most similar meta operation: Get the loop variable of for-each loop
cosine Similarity: 0.9849274754524231
*Get the body of the for-each loop.* 匹配到的元操作或API：
query: Get the body of the for-each loop.
most similar API: get body of foreach statement: Returns the statement that represents the body of this loop.
cosine Similarity: 0.8478140830993652
*Check whether the body contains a constructor call.* 匹配到的元操作或API：
query: Check whether the body contains a constructor call.
most similar API: Check whether the constructor call equals
cosine Similarity: 0.8527532815933228
*Get the type of object created by the constructor call.* 匹配到的元操作或API：
logic: Get the type of object created by the constructor call.
most similar meta operation: Get the type of object created by constructor call
cosine Similarity: 0.983032763004303
=========================logics=========================
1. Check whether the class is public.
2. Get the name of the class.
3. Check whether the name of the class is "Foo".
4. Get the method named "test1".
5. Check whether the method is public.
6. Get the while loop in the method.
7. Get the condition of the while statement.
8. Check whether the condition of the while statement is a method call.
9. Get the caller of the method.
10. Check whether the caller of the method is a new object creation.
If the method named "test1" contains a while loop whose condition is a method call on a newly created object, then this test case violates the rule.
*Check whether the class is public.* 匹配到的元操作或API：
logic: Check whether the class is public.
most similar meta operation: Check whether the class is public
cosine Similarity: 0.9849746227264404
*Get the name of the class.* 匹配到的元操作或API：
logic: Get the name of the class.
most similar meta operation: Get the name of class
cosine Similarity: 0.968898594379425
*Check whether the name of the class is "Foo".* 匹配到的元操作或API：
query: Check whether the name of the class is "Foo".
most similar API: Check whether is test class
cosine Similarity: 0.8006636500358582
*Get the method named "test1".* 匹配到的元操作或API：
query: Get the method named "test1".
most similar API: get name of method
cosine Similarity: 0.8155225515365601
*Check whether the method is public.* 匹配到的元操作或API：
logic: Check whether the method is public.
most similar meta operation: Check whether the method is public
cosine Similarity: 0.982057511806488
*Get the while loop in the method.* 匹配到的元操作或API：
query: Get the while loop in the method.
most similar API: get text of while statement
cosine Similarity: 0.8426483273506165
*Get the condition of the while statement.* 匹配到的元操作或API：
logic: Get the condition of the while statement.
most similar meta operation: Get the condition of while statement
cosine Similarity: 0.9793691039085388
*Check whether the condition of the while statement is a method call.* 匹配到的元操作或API：
query: Check whether the condition of the while statement is a method call.
most similar API: Check whether the method call equals
cosine Similarity: 0.8464482426643372
*Get the caller of the method.* 匹配到的元操作或API：
logic: Get the caller of the method.
most similar meta operation: Get the method caller
cosine Similarity: 0.9634376168251038
*Check whether the caller of the method is a new object creation.* 匹配到的元操作或API：
query: Check whether the caller of the method is a new object creation.
most similar API: Check whether the constructor call is qualified instance creation
cosine Similarity: 0.8476169109344482
156
136
=========================logics=========================
1. Get the loop statement.
2. Get the body of loop statement.
3. Check whether the body of loop statement contains a constructor call to create a new object.
If a loop statement's body contains a constructor call to create a new object, then this test case violate the rule.
*Get the loop statement.* 匹配到的元操作或API：
query: Get the loop statement.
most similar API: get body of for statement: Returns the statement that represents the body of this loop.
cosine Similarity: 0.8175114989280701
*Get the body of loop statement.* 匹配到的元操作或API：
query: Get the body of loop statement.
most similar API: get body of for statement: Returns the statement that represents the body of this loop.
cosine Similarity: 0.9263396263122559
*Check whether the body of loop statement contains a constructor call to create a new object.* 匹配到的元操作或API：
query: Check whether the body of loop statement contains a constructor call to create a new object.
most similar API: Check whether the constructor call equals
cosine Similarity: 0.8403639793395996
=========================logics=========================
1. Get the loop statement.
2. Get the body of the loop.
3. Check whether the body of the loop contains an object creation expression.
4. Get the object created by constructor call.
5. Check whether the type of object created by constructor call is a class type.
If the body of the loop contains a new object creation expression of a class type, then this test case violates the rule.
*Get the loop statement.* 匹配到的元操作或API：
query: Get the loop statement.
most similar API: get body of for statement: Returns the statement that represents the body of this loop.
cosine Similarity: 0.8175114989280701
*Get the body of the loop.* 匹配到的元操作或API：
query: Get the body of the loop.
most similar API: get body of for statement: Returns the statement that represents the body of this loop.
cosine Similarity: 0.8687449097633362
*Check whether the body of the loop contains an object creation expression.* 匹配到的元操作或API：
query: Check whether the body of the loop contains an object creation expression.
most similar API: Check whether the constructor call is expression
cosine Similarity: 0.8206040263175964
*Get the object created by constructor call.* 匹配到的元操作或API：
logic: Get the object created by constructor call.
most similar meta operation: Get the type of object created by constructor call
cosine Similarity: 0.8863864541053772
*Check whether the type of object created by constructor call is a class type.* 匹配到的元操作或API：
logic: Check whether the type of object created by constructor call is a class type.
most similar meta operation: Get the type of object created by constructor call
cosine Similarity: 0.9034793376922607
=========================logics=========================
1. Get the body of for loop.
2. Check whether the body contains an object creation expression.
If the body of the loop contains an object creation expression, then this test case violates the rule.
*Get the body of for loop.* 匹配到的元操作或API：
query: Get the body of for loop.
most similar API: get body of for statement
cosine Similarity: 0.9184505939483643
*Check whether the body contains an object creation expression.* 匹配到的元操作或API：
query: Check whether the body contains an object creation expression.
most similar API: Check whether the constructor call is expression
cosine Similarity: 0.8143839836120605
93
78
=========================logics=========================
1. Get the loop statement from the method.
2. Get the body of the loop statement.
3. Check whether the body contains new object creation expressions.
4. Check whether the new object created is an array. 
If the loop body contains the creation of a new array object, then this test case violates the rule.
*Get the loop statement from the method.* 匹配到的元操作或API：
query: Get the loop statement from the method.
most similar API: get body of foreach statement: Returns the statement that represents the body of this loop.
cosine Similarity: 0.8078296780586243
*Get the body of the loop statement.* 匹配到的元操作或API：
query: Get the body of the loop statement.
most similar API: get body of foreach statement: Returns the statement that represents the body of this loop.
cosine Similarity: 0.9144570827484131
*Check whether the body contains new object creation expressions.* 匹配到的元操作或API：
未匹配成功元操作或API
*Check whether the new object created is an array.* 匹配到的元操作或API：
query: Check whether the new object created is an array.
most similar API: Check whether the array type is array type
cosine Similarity: 0.8311823606491089
=========================logics=========================
1. Get the loop variable of for-each loop.
2. Check whether the loop variable is an array.
3. Get the operand of the loop variable.
4. Check whether the operand is a new object creation expression.
If a newly created array is used as the operand in a for-each loop, then this test case violates the rule.
*Get the loop variable of for-each loop.* 匹配到的元操作或API：
logic: Get the loop variable of for-each loop.
most similar meta operation: Get the loop variable of for-each loop
cosine Similarity: 0.9849274754524231
*Check whether the loop variable is an array.* 匹配到的元操作或API：
logic: Check whether the loop variable is an array.
most similar meta operation: Check whether the local variable is array type
cosine Similarity: 0.8678908348083496
*Get the operand of the loop variable.* 匹配到的元操作或API：
logic: Get the operand of the loop variable.
most similar meta operation: Get a loop variable of for loop
cosine Similarity: 0.8519278764724731
*Check whether the operand is a new object creation expression.* 匹配到的元操作或API：
query: Check whether the operand is a new object creation expression.
most similar API: Check whether the method call is expression
cosine Similarity: 0.8023033738136292
89
74
=========================logics=========================
1. Get the body of the for loop.
2. Check if there is an object creation within the body of the for loop.
3. Get the type of object created by constructor call.
4. Check whether the created object is directly assigned to a variable or field.
5. If assigned, check whether the assigned variable or field is a collection type or an array type.
If the object created within the loop is directly assigned to a collection or an array, then the test case does not violate the rule.
*Get the body of the for loop.* 匹配到的元操作或API：
query: Get the body of the for loop.
most similar API: get body of for statement
cosine Similarity: 0.9058630466461182
*Check if there is an object creation within the body of the for loop.* 匹配到的元操作或API：
未匹配成功元操作或API
*Get the type of object created by constructor call.* 匹配到的元操作或API：
logic: Get the type of object created by constructor call.
most similar meta operation: Get the type of object created by constructor call
cosine Similarity: 0.9878885746002197
*Check whether the created object is directly assigned to a variable or field.* 匹配到的元操作或API：
未匹配成功元操作或API
*If assigned, check whether the assigned variable or field is a collection type or an array type.* 匹配到的元操作或API：
logic: If assigned, check whether the assigned variable or field is a collection type or an array type.
most similar meta operation: Check whether the field is array type
cosine Similarity: 0.8678929805755615
=========================logics=========================
1. Get the loop statement in the method.
2. Check whether there is an object creation within the loop.
3. Get the type of object created by constructor call.
If an object is being instantiated within a loop, then this test case violates the rule.
*Get the loop statement in the method.* 匹配到的元操作或API：
query: Get the loop statement in the method.
most similar API: get body of foreach statement: Returns the statement that represents the body of this loop.
cosine Similarity: 0.8112729787826538
*Check whether there is an object creation within the loop.* 匹配到的元操作或API：
未匹配成功元操作或API
*Get the type of object created by constructor call.* 匹配到的元操作或API：
logic: Get the type of object created by constructor call.
most similar meta operation: Get the type of object created by constructor call
cosine Similarity: 0.9878885746002197
=========================logics=========================
1. Get the body of the loop statement.
2. Check whether the body contains method calls.
3. For each method call, get the return type of called method.
4. Check whether the return type of the called method is a new object.
If the body of the loop statement contains a method call that returns a new object, then this test case violates the rule.
*Get the body of the loop statement.* 匹配到的元操作或API：
query: Get the body of the loop statement.
most similar API: get body of for statement: Returns the statement that represents the body of this loop.
cosine Similarity: 0.9237593412399292
*Check whether the body contains method calls.* 匹配到的元操作或API：
query: Check whether the body contains method calls.
most similar API: Check whether the method call is find boundary
cosine Similarity: 0.8072698712348938
*For each method call, get the return type of called method.* 匹配到的元操作或API：
logic: For each method call, get the return type of called method.
most similar meta operation: Get the return type of called method
cosine Similarity: 0.938018262386322
*Check whether the return type of the called method is a new object.* 匹配到的元操作或API：
logic: Check whether the return type of the called method is a new object.
most similar meta operation: Check whether the return type of called method is string
cosine Similarity: 0.8659005165100098
=========================logics=========================
1. Get the body of the loop statement.
2. Check whether the body contains an expression.
3. Get the expression in the body of the loop.
4. Check whether the expression is a variable assignment.
5. Get the right operand of the assignment expression.
6. Check whether the operand is creating a new object.
If the body of the loop statement contains a variable assignment expression that instantiates a new object, then this test case violates the rule. However, this test case doesn't violate the rule as it's only creating a new array, not a new object.

*Get the body of the loop statement.* 匹配到的元操作或API：
query: Get the body of the loop statement.
most similar API: get body of for statement: Returns the statement that represents the body of this loop.
cosine Similarity: 0.9237593412399292
*Check whether the body contains an expression.* 匹配到的元操作或API：
logic: Check whether the body contains an expression.
most similar meta operation: Check whether lambda expression has an expression for body
cosine Similarity: 0.8718124032020569
*Get the expression in the body of the loop.* 匹配到的元操作或API：
query: Get the expression in the body of the loop.
most similar API: get expr of expression statement
cosine Similarity: 0.846537172794342
*Check whether the expression is a variable assignment.* 匹配到的元操作或API：
query: Check whether the expression is a variable assignment.
most similar API: Check whether the assignment expression is expression
cosine Similarity: 0.9131249189376831
*Get the right operand of the assignment expression.* 匹配到的元操作或API：
logic: Get the right operand of the assignment expression.
most similar meta operation: Get the right operand of assignment expression
cosine Similarity: 0.9825876355171204
*Check whether the operand is creating a new object.* 匹配到的元操作或API：
未匹配成功元操作或API
=========================logics=========================
1. Get the body of the method.
2. Check whether the body contains a loop statement.
3. Get the body of the loop statement.
4. Check whether the body contains a constructor call.
5. Get the object created by the constructor call.
6. Check whether the object is an array.
If the loop statement body contains a constructor call that creates an array, then this test case violate the rule.
*Get the body of the method.* 匹配到的元操作或API：
query: Get the body of the method.
most similar API: get body of method
cosine Similarity: 0.9667365550994873
*Check whether the body contains a loop statement.* 匹配到的元操作或API：
未匹配成功元操作或API
*Get the body of the loop statement.* 匹配到的元操作或API：
query: Get the body of the loop statement.
most similar API: get body of for statement: Returns the statement that represents the body of this loop.
cosine Similarity: 0.9237593412399292
*Check whether the body contains a constructor call.* 匹配到的元操作或API：
未匹配成功元操作或API
*Get the object created by the constructor call.* 匹配到的元操作或API：
logic: Get the object created by the constructor call.
most similar meta operation: Get the type of object created by constructor call
cosine Similarity: 0.8730127811431885
*Check whether the object is an array.* 匹配到的元操作或API：
logic: Check whether the object is an array.
most similar meta operation: Check whether the argument is array type
cosine Similarity: 0.8536121845245361
=========================logics=========================
1. Get the body of the loop statement.
        2. Check whether the body contains a constructor call.
        3. Get the type of object created by the constructor call.
        4. Check whether the type of object is an array type.
        If the body of the loop statement contains a constructor call that creates an array, then this test case violate the rule.

*Get the body of the loop statement.* 匹配到的元操作或API：
query: Get the body of the loop statement.
most similar API: get body of foreach statement: Returns the statement that represents the body of this loop.
cosine Similarity: 0.9144570827484131
*Check whether the body contains a constructor call.* 匹配到的元操作或API：
query: Check whether the body contains a constructor call.
most similar API: Check whether the constructor call equals
cosine Similarity: 0.8527532815933228
*Get the type of object created by the constructor call.* 匹配到的元操作或API：
logic: Get the type of object created by the constructor call.
most similar meta operation: Get the type of object created by constructor call
cosine Similarity: 0.983032763004303
*Check whether the type of object is an array type.* 匹配到的元操作或API：
logic: Check whether the type of object is an array type.
most similar meta operation: Check whether the array is string type
cosine Similarity: 0.895054042339325
==========================第1轮生成checker========================
开始写checker
==========================The_first_checker_query=========================
You are an expert in writing java rule checkers and I need your help to generate a custom java rule checker in PMD tool version 7.0.0. 
I will give you a rule description and its several test cases.

The following is the description of the rule:
Rule description: New objects can not be created within loops;

The following are the test cases of the rule:
1. This is a negative test case
```java
// TEST1
public class Foo {
    public void test1() {
        for(;;) {
            String a = new String();
        }
    }
}
```
2. This is a negative test case
```java
// TEST2
public class Foo {
    public void test1() {
        while(true) {
            String a = new String();
        }
    }
}
```
3. This is a negative test case
```java
// TEST3
public class Foo {
    public void test1() {
        do {
            String a = new String();
        } while(true);
    }
}
```
4. This is a negative test case
```java
// TEST4
public class Foo {
    public void test1() {
        do {
            String a = new String();
        } while(true);
    }
}
```
5. This is a positive test case
```java
// throw new is OK
public class Foo {
    public void test1() {
        for(;;) {
            throw new Exception();
        }
    }
}
```
6. This is a positive test case
```java
// return new in loop is OK
public class Foo {
    public String test1() {
        for(;;) {
            return new String();
        }
    }
}
```
7. This is a positive test case
```java
// #278 Semi-false positive for instantiating new object in loop
public class Foo {
    public void test1() {
        while (true) {
            try {
            } catch (Exception e) {
                url = new StringBuffer();
                break;
            }
        }
    }
}
```
8. This is a positive test case
```java
// #1215 AvoidInstantiatingObjectsInLoops matches the right side of a list iteration loop
import java.util.ArrayList;
import java.io.File;

public class TestInstantiationInLoop {
    public static void main(String args[]) {
        for (String test : new ArrayList<String>()) { // facetious but simple example
            System.out.println(test);
        }
        for (String filename : new File("subdirectory").list()) { // complex but realistically conceivable (albeit exagerrated/oversimplified/rarely advisable) example
            System.out.println(filename);
        }
    }
}
```
9. This is a positive test case
```java
// [java] False positive: AvoidInstantiatingObjectsInLoops should not flag objects with different parameters or objects assigned or passed as parameters #2207
import java.awt.Dimension;

public class PMDDemo {
    public static void main(final String[] args) {
        final Dimension[] arr = new Dimension[10];
        for (int i = 0; i < arr.length; i++) {
            arr[i] = new Dimension(i, i); // rule violation here
        }
    }
}
```
10. This is a positive test case
```java
// False positive when assigning to a list/array (see #2207 and #1043)
import java.util.Collection;
import java.util.ArrayList;

public class PMDDemo {
    public void checkArray() {
        Car[] cars = new Car[3];
        for(int i = 0; i < cars.length; ++i) {
           cars[i] = new Car();
        }
    }
    public void checkCollection() {
        Collection<Car> cars = new ArrayList<>();
        for(int i = 0; i < 3; ++i) {
           cars.add(new Car());
        }
    }

    private static class Car {}
}
```
11. This is a negative test case
```java
// False negative with break in other for-loop
import java.util.function.Function;
import java.util.List;
import java.util.SortedSet;
import java.util.TreeSet;

public class Message {
    private List<Function<Message, Boolean>> filters;

    public Message(Message message) {}

    private SortedSet<Message> getFilteredMessages(List<Message> messages) {
        final SortedSet<Message> result = new TreeSet<>(messages);
        for (Message element : messages) {
            Message event = new Message(element);
            for (Function<Message, Boolean> filter : filters) {
                if (!filter.apply(event)) {
                    result.remove(element);
                    break;
                }
            }
        }
        return result;
    }
}
```
12. This is a negative test case
```java
// Instantiation in loop condition
public class Foo {
    public void test1() {
        while(new String().length() > 0) {
        }
    }
}
```
13. This is a negative test case
```java
// false negative in anonymous classes
public class Sample {
    private static class Inner {
        private void baz() {
            for(;;) {
                String a = new String();
            }
        }
    }

    public void foo() {
        Sample anonymousClass = new Sample() {
            void bar() {
                for(;;) {
                    String a = new String();
                }
            }
        };
    }
}
```
14. This is a positive test case
```java
// false positive with list
import java.util.Collection;
import java.util.ArrayList;

public class Sample {
    public Collection<Car> checkCollection() {
        Collection<Car> thisIsACar = new ArrayList<>();
        for(int i = 0; i < 3; ++i) {
            thisIsACar.add(new Car());
        }
        return thisIsACar;
    }

    private static class Car {
    }
}
```
15. This is a negative test case
```java
// Collections with unresolved type
// Types are unresolved
//import java.util.Collection;
//import java.util.ArrayList;

public class Sample {
    public Collection<Car> checkCollection() {
        Collection<Car> thisIsACar = new ArrayList<>();
        for(int i = 0; i < 3; ++i) {
            thisIsACar.add(new Car());
        }
        return thisIsACar;
    }

    private static class Car {
    }
}
```
16. This is a negative test case
```java
// False negative with array allocations within loops
public class AvoidInstantiatingArraysInLoops {
    public static void main(String[] args) {
        for (String arg : args) {
            String[] copy = new String[] { arg };
        }
    }
}
```
17. This is a positive test case
```java
// False positive with for-each loop over new array
public class AvoidInstantiatingArrayInLoops {
    public static void main(String[] args) {
        for (String configName : new String[] {"config", "test"}) {
            System.out.println(configName);
        }
    }
}
```
18. This is a positive test case
```java
// False positive with adding to a collection/array field
import java.util.ArrayList;
import java.util.List;

public class AvoidInstantiatingObjectsInLoops {
    private List<String> field = new ArrayList<>();
    private String[] arrayField = new String[10];

    public static void main(String[] args) {
        for (String arg : args) {
            this.field.add(new String(arg));
        }
        for (int i = 0; i < args.length; i++) {
            this.arrayField[i] = new String(args[i]);
        }
    }
}
```
19. This is a positive test case
```java
// False positive with adding wrapped new arrays to collection
import java.nio.ByteBuffer;
import java.nio.charset.StandardCharsets;
import java.util.ArrayList;
import java.util.List;

public class AvoidInstantiatingObjectsInLoops {
    public void testBytes(String s) {
        byte[] bytes = s.getBytes(StandardCharsets.UTF_8);
        List<ByteBuffer> buffers = new ArrayList<>();
        for (byte b : bytes) {
            buffers.add(ByteBuffer.wrap(new byte[]{b}));
        }
    }
}
```
20. This is a positive test case
```java
// False positive with temporary object assigned to an array
public class AvoidInstantiatingObjectsInLoops {
    public static void main(String[] args) {
        String[] data = new String[10];
        for (int i = 0; i < data.length; i++) {
            data[i] = new StringBuilder().append("foo").toString();
        }
    }
}
```
21. This is a positive test case
```java
// False positive with array allocation and assignment
public class AvoidInstantiatingArraysInLoops {
    public static void main(String[] args) {
        int[][] arr = new int[10];
        for (int i = 0; i < 10; i++) {
            arr[i] = new int[] { i };
        }
    }
}
```
22. This is a positive test case
```java
// False positive when array is returned
public class AvoidInstantiatingArraysInLoops {
    public int[] test() {
        for (int i = 0; i < 10; i++) {
            return new int[] { i };
        }

        for (int i = 0; i < 10; i++) {
            int[] a = new int[] { i };
            break;
        }
    }
}
```
23. This is a positive test case
```java
// False positive when converting collection to array
import java.util.ArrayList;
import java.util.List;

public class AvoidInsantiatingArraysInLoops {
    public void test() {
        List<String> data = new ArrayList<>();

        for (String arg : args) {
            this.consume(data.toArray(new String[0]));
        }
    }

    private void consume(String[] array) { }
}
```


The checker code framework(you must conform to):
```java
package net.sourceforge.pmd.lang.java.rule.performance;
import net.sourceforge.pmd.lang.java.rule.AbstractJavaRulechainRule;
import net.sourceforge.pmd.lang.java.ast.*;
import net.sourceforge.pmd.lang.java.ast.internal.*;
import net.sourceforge.pmd.lang.java.types.*;
import net.sourceforge.pmd.lang.java.symbols.*;
import net.sourceforge.pmd.lang.java.ast.JavaNode;
import net.sourceforge.pmd.lang.ast.NodeStream;
import java.util.*;
import java.lang.*;

public class AvoidInstantiatingObjectsInLoopsRule extends AbstractJavaRulechainRule {
    public rule_name() {
        super(node1_Of_AST_to_visit.class, node2_Of_AST_to_visit.class, ...);
    }
    @Override
    public Object visit(node1_Of_AST_to_visit node, Object data) {
        return super.visit(node, data);
    }
    @Override
    public Object visit(node2_Of_AST_to_visit node, Object data) {
        return super.visit(node, data);
    }
    ...
}
```
Some useful packages are already imported, if you need other packages, please import additionally.
Please give me the complete checker code including the import info, do not contain pseudocode, and do not give it step by step. No comment needed.

Below are some APIs and code snippets consisting of existing APIs, they implement specific functionality, you can selectively use them directly without changing it if you need:
1. net.sourceforge.pmd.lang.java.ast.ASTForStatement: public net.sourceforge.pmd.lang.java.ast.ASTStatement getBody(), //Returns the statement that represents the body of this loop.
2. net.sourceforge.pmd.lang.java.ast.ASTConstructorCall: public boolean equals(java.lang.Object)
3. net.sourceforge.pmd.lang.java.ast.ASTConstructorCall: public net.sourceforge.pmd.lang.java.ast.ASTClassOrInterfaceType getTypeNode()
4. net.sourceforge.pmd.lang.java.ast.ASTWhileStatement: public boolean equals(java.lang.Object)
5. net.sourceforge.pmd.lang.java.ast.ASTDoStatement: public net.sourceforge.pmd.lang.java.ast.ASTStatement getBody(), //Returns the statement that will be run while the guard evaluates to true.
6. net.sourceforge.pmd.lang.java.ast.ASTConstructorCall: public boolean isQualifiedInstanceCreation(), //Returns true if this expression begins with a primary expression. Such an expression creates an instance of inner member classes and their anonymous subclasses. For example, {@code new Outer().new Inner()} evaluates to an instance of the Inner class, which is nested inside the new instance of Outer.
7. net.sourceforge.pmd.lang.java.ast.ASTForeachStatement: public net.sourceforge.pmd.lang.java.ast.ASTVariableDeclaratorId getVarId()
8. net.sourceforge.pmd.lang.java.ast.ASTConstructorCall: public boolean isExpression(), //Always returns true. This is to allow XPath queries to query like {@code /[@Expression=true()]} to match any expression, but is useless in Java code.
9. net.sourceforge.pmd.lang.java.ast.ASTForeachStatement: public net.sourceforge.pmd.lang.java.ast.ASTStatement getBody(), //Returns the statement that represents the body of this loop.
10. net.sourceforge.pmd.lang.java.ast.ASTClassOrInterfaceDeclaration: public boolean isPublic()
11. net.sourceforge.pmd.lang.java.ast.ASTClassOrInterfaceDeclaration: public java.lang.String getSimpleName()
12. net.sourceforge.pmd.lang.java.rule.internal.TestFrameworksUtil: static public boolean isTestClass(net.sourceforge.pmd.lang.java.ast.ASTAnyTypeDeclaration)
13. net.sourceforge.pmd.lang.java.ast.ASTMethodDeclaration: public java.lang.String getName(), //Returns the simple name of the method.
14. net.sourceforge.pmd.lang.java.ast.ASTMethodDeclaration: public boolean isPublic()
15. net.sourceforge.pmd.lang.java.ast.ASTWhileStatement: public net.sourceforge.pmd.lang.document.Chars getText()
16. net.sourceforge.pmd.lang.java.ast.ASTWhileStatement: public net.sourceforge.pmd.lang.java.ast.ASTExpression getCondition()
17. net.sourceforge.pmd.lang.java.ast.ASTMethodCall: public boolean equals(java.lang.Object)
18. net.sourceforge.pmd.lang.java.ast.ASTMethodCall: public net.sourceforge.pmd.lang.java.ast.ASTExpression getQualifier()
19. net.sourceforge.pmd.lang.java.ast.ASTArrayType: public boolean isArrayType()
20. net.sourceforge.pmd.lang.java.ast.internal.JavaAstUtils: static public net.sourceforge.pmd.lang.ast.NodeStream<ASTVariableDeclaratorId> getLoopVariables(net.sourceforge.pmd.lang.java.ast.ASTForStatement)
21. net.sourceforge.pmd.lang.java.ast.ASTMethodCall: public boolean isExpression(), //Always returns true. This is to allow XPath queries to query like {@code /[@Expression=true()]} to match any expression, but is useless in Java code.
22. net.sourceforge.pmd.lang.java.ast.ASTMethodCall: public boolean isFindBoundary()
23. net.sourceforge.pmd.lang.java.ast.ASTLambdaExpression: public boolean isExpressionBody()
24. net.sourceforge.pmd.lang.java.ast.ASTExpressionStatement: public net.sourceforge.pmd.lang.java.ast.ASTExpression getExpr(), //Returns the contained expression.
25. net.sourceforge.pmd.lang.java.ast.ASTAssignmentExpression: public boolean isExpression(), //Always returns true. This is to allow XPath queries to query like {@code /[@Expression=true()]} to match any expression, but is useless in Java code.
26. net.sourceforge.pmd.lang.java.ast.ASTAssignmentExpression: public net.sourceforge.pmd.lang.java.ast.ASTExpression getRightOperand()
27. net.sourceforge.pmd.lang.java.ast.ASTMethodDeclaration: public net.sourceforge.pmd.lang.java.ast.ASTBlock getBody(), //Returns the body of this method or constructor. Returns null if this is the declaration of an abstract method.

1.  //Check whether the local variable is array type
```java
import net.sourceforge.pmd.lang.java.ast.ASTLocalVariableDeclaration;
import net.sourceforge.pmd.lang.java.ast.ASTType;
public boolean isLocalVariableArrayType(ASTLocalVariableDeclaration node) {
    ASTType type = node.getTypeNode();
    return type.getTypeMirror().isArray();
}
```
2.  //Check whether the field is array type
```java
import net.sourceforge.pmd.lang.java.ast.ASTFieldDeclaration;
import net.sourceforge.pmd.lang.java.ast.ASTType;
public boolean isFieldArrayType(ASTFieldDeclaration node) {
    ASTType type = node.getTypeNode();
    return type.getTypeMirror().isArray();
}
```
3.  //Get the return type of called method
```java
import net.sourceforge.pmd.lang.java.ast.ASTMethodCall;
import net.sourceforge.pmd.lang.java.types.JMethodSig;
import net.sourceforge.pmd.lang.java.types.JTypeMirror;
public JTypeMirror getReturnType(ASTMethodCall call) {
    JMethodSig m = call.getMethodType();
    return m.getReturnType();
}
```
4.  //Check whether the return type of called method is string
```java
import net.sourceforge.pmd.lang.java.ast.ASTMethodCall;
import net.sourceforge.pmd.lang.java.types.JMethodSig;
import net.sourceforge.pmd.lang.java.types.TypeTestUtil;
public boolean isReturnStringType(ASTMethodCall call) {
    JMethodSig m = call.getMethodType();
    return TypeTestUtil.isA(String.class, m.getReturnType());
}
```
5.  //Check whether the argument is array type
```java
import net.sourceforge.pmd.lang.java.ast.ASTMethodCall;
import net.sourceforge.pmd.lang.java.ast.ASTArgumentList;
import net.sourceforge.pmd.lang.java.ast.ASTExpression;
public boolean isMethodCallArgumentArrayType(ASTMethodCall node) {
   ASTArgumentList astArgumentList = node.getArguments();
    //select which argument to judge
    ASTExpression expression = astArgumentList.get(0);
    return expression.getTypeMirror().isArray();
}
```
6.  //Check whether the array is string type
```java
import net.sourceforge.pmd.lang.java.ast.ASTVariableDeclaratorId;
import net.sourceforge.pmd.lang.java.ast.ASTArrayType;
import net.sourceforge.pmd.lang.java.ast.ASTType;
import net.sourceforge.pmd.lang.java.ast.ASTClassOrInterfaceType;
import net.sourceforge.pmd.lang.java.types.TypeTestUtil;
public boolean isArrayStringType(ASTVariableDeclaratorId node) {
    if(node.getType().isArray()){
        ASTArrayType arrayType = (ASTArrayType)node.getTypeNode();
        ASTType astType = (ASTType) arrayType.getChild(0);
        if(astType instanceof ASTClassOrInterfaceType){
            ASTClassOrInterfaceType classOrInterfaceType = (ASTClassOrInterfaceType)astType;
            return TypeTestUtil.isA(String.class, classOrInterfaceType);
        }
    }
    return false;
}
```


Below are some edge-related APIs to help traverse abstract syntax tree, if you need, you can use them:
1. public net.sourceforge.pmd.lang.ast.NodeStream<JavaNode> children()
2. public net.sourceforge.pmd.lang.ast.NodeStream<JavaNode> children(java.lang.Class)
3. public N getChild(int i)
4. public N getFirstChild()
5. public N getLastChild()
6. public N firstChild(java.lang.Class)
7. public int getNumChildren()
8. public int getIndexInParent()
9. public net.sourceforge.pmd.lang.ast.NodeStream.DescendantNodeStream<JavaNode> descendants()
10. public net.sourceforge.pmd.lang.ast.NodeStream.DescendantNodeStream<JavaNode> descendants(java.lang.Class)
11. public net.sourceforge.pmd.lang.ast.NodeStream.DescendantNodeStream<JavaNode> descendantsOrSelf()
12. public N getParent()
13. public N getNthParent(int i)
14. public net.sourceforge.pmd.lang.ast.NodeStream<JavaNode> ancestors()
15. public net.sourceforge.pmd.lang.ast.NodeStream<JavaNode> ancestors(java.lang.Class)
16. public net.sourceforge.pmd.lang.ast.NodeStream<JavaNode> ancestorsOrSelf()
17. public N getPreviousSibling()
18. public N getNextSibling()

Please do not use the following API:


出现语法错误，这一轮舍弃，直接重新生成
==========================第2轮生成checker========================
开始写checker
==========================The_first_checker_query=========================
You are an expert in writing java rule checkers and I need your help to generate a custom java rule checker in PMD tool version 7.0.0. 
I will give you a rule description and its several test cases.

The following is the description of the rule:
Rule description: New objects can not be created within loops;

The following are the test cases of the rule:
1. This is a negative test case
```java
// TEST1
public class Foo {
    public void test1() {
        for(;;) {
            String a = new String();
        }
    }
}
```
2. This is a negative test case
```java
// TEST2
public class Foo {
    public void test1() {
        while(true) {
            String a = new String();
        }
    }
}
```
3. This is a negative test case
```java
// TEST3
public class Foo {
    public void test1() {
        do {
            String a = new String();
        } while(true);
    }
}
```
4. This is a negative test case
```java
// TEST4
public class Foo {
    public void test1() {
        do {
            String a = new String();
        } while(true);
    }
}
```
5. This is a positive test case
```java
// throw new is OK
public class Foo {
    public void test1() {
        for(;;) {
            throw new Exception();
        }
    }
}
```
6. This is a positive test case
```java
// return new in loop is OK
public class Foo {
    public String test1() {
        for(;;) {
            return new String();
        }
    }
}
```
7. This is a positive test case
```java
// #278 Semi-false positive for instantiating new object in loop
public class Foo {
    public void test1() {
        while (true) {
            try {
            } catch (Exception e) {
                url = new StringBuffer();
                break;
            }
        }
    }
}
```
8. This is a positive test case
```java
// #1215 AvoidInstantiatingObjectsInLoops matches the right side of a list iteration loop
import java.util.ArrayList;
import java.io.File;

public class TestInstantiationInLoop {
    public static void main(String args[]) {
        for (String test : new ArrayList<String>()) { // facetious but simple example
            System.out.println(test);
        }
        for (String filename : new File("subdirectory").list()) { // complex but realistically conceivable (albeit exagerrated/oversimplified/rarely advisable) example
            System.out.println(filename);
        }
    }
}
```
9. This is a positive test case
```java
// [java] False positive: AvoidInstantiatingObjectsInLoops should not flag objects with different parameters or objects assigned or passed as parameters #2207
import java.awt.Dimension;

public class PMDDemo {
    public static void main(final String[] args) {
        final Dimension[] arr = new Dimension[10];
        for (int i = 0; i < arr.length; i++) {
            arr[i] = new Dimension(i, i); // rule violation here
        }
    }
}
```
10. This is a positive test case
```java
// False positive when assigning to a list/array (see #2207 and #1043)
import java.util.Collection;
import java.util.ArrayList;

public class PMDDemo {
    public void checkArray() {
        Car[] cars = new Car[3];
        for(int i = 0; i < cars.length; ++i) {
           cars[i] = new Car();
        }
    }
    public void checkCollection() {
        Collection<Car> cars = new ArrayList<>();
        for(int i = 0; i < 3; ++i) {
           cars.add(new Car());
        }
    }

    private static class Car {}
}
```
11. This is a negative test case
```java
// False negative with break in other for-loop
import java.util.function.Function;
import java.util.List;
import java.util.SortedSet;
import java.util.TreeSet;

public class Message {
    private List<Function<Message, Boolean>> filters;

    public Message(Message message) {}

    private SortedSet<Message> getFilteredMessages(List<Message> messages) {
        final SortedSet<Message> result = new TreeSet<>(messages);
        for (Message element : messages) {
            Message event = new Message(element);
            for (Function<Message, Boolean> filter : filters) {
                if (!filter.apply(event)) {
                    result.remove(element);
                    break;
                }
            }
        }
        return result;
    }
}
```
12. This is a negative test case
```java
// Instantiation in loop condition
public class Foo {
    public void test1() {
        while(new String().length() > 0) {
        }
    }
}
```
13. This is a negative test case
```java
// false negative in anonymous classes
public class Sample {
    private static class Inner {
        private void baz() {
            for(;;) {
                String a = new String();
            }
        }
    }

    public void foo() {
        Sample anonymousClass = new Sample() {
            void bar() {
                for(;;) {
                    String a = new String();
                }
            }
        };
    }
}
```
14. This is a positive test case
```java
// false positive with list
import java.util.Collection;
import java.util.ArrayList;

public class Sample {
    public Collection<Car> checkCollection() {
        Collection<Car> thisIsACar = new ArrayList<>();
        for(int i = 0; i < 3; ++i) {
            thisIsACar.add(new Car());
        }
        return thisIsACar;
    }

    private static class Car {
    }
}
```
15. This is a negative test case
```java
// Collections with unresolved type
// Types are unresolved
//import java.util.Collection;
//import java.util.ArrayList;

public class Sample {
    public Collection<Car> checkCollection() {
        Collection<Car> thisIsACar = new ArrayList<>();
        for(int i = 0; i < 3; ++i) {
            thisIsACar.add(new Car());
        }
        return thisIsACar;
    }

    private static class Car {
    }
}
```
16. This is a negative test case
```java
// False negative with array allocations within loops
public class AvoidInstantiatingArraysInLoops {
    public static void main(String[] args) {
        for (String arg : args) {
            String[] copy = new String[] { arg };
        }
    }
}
```
17. This is a positive test case
```java
// False positive with for-each loop over new array
public class AvoidInstantiatingArrayInLoops {
    public static void main(String[] args) {
        for (String configName : new String[] {"config", "test"}) {
            System.out.println(configName);
        }
    }
}
```
18. This is a positive test case
```java
// False positive with adding to a collection/array field
import java.util.ArrayList;
import java.util.List;

public class AvoidInstantiatingObjectsInLoops {
    private List<String> field = new ArrayList<>();
    private String[] arrayField = new String[10];

    public static void main(String[] args) {
        for (String arg : args) {
            this.field.add(new String(arg));
        }
        for (int i = 0; i < args.length; i++) {
            this.arrayField[i] = new String(args[i]);
        }
    }
}
```
19. This is a positive test case
```java
// False positive with adding wrapped new arrays to collection
import java.nio.ByteBuffer;
import java.nio.charset.StandardCharsets;
import java.util.ArrayList;
import java.util.List;

public class AvoidInstantiatingObjectsInLoops {
    public void testBytes(String s) {
        byte[] bytes = s.getBytes(StandardCharsets.UTF_8);
        List<ByteBuffer> buffers = new ArrayList<>();
        for (byte b : bytes) {
            buffers.add(ByteBuffer.wrap(new byte[]{b}));
        }
    }
}
```
20. This is a positive test case
```java
// False positive with temporary object assigned to an array
public class AvoidInstantiatingObjectsInLoops {
    public static void main(String[] args) {
        String[] data = new String[10];
        for (int i = 0; i < data.length; i++) {
            data[i] = new StringBuilder().append("foo").toString();
        }
    }
}
```
21. This is a positive test case
```java
// False positive with array allocation and assignment
public class AvoidInstantiatingArraysInLoops {
    public static void main(String[] args) {
        int[][] arr = new int[10];
        for (int i = 0; i < 10; i++) {
            arr[i] = new int[] { i };
        }
    }
}
```
22. This is a positive test case
```java
// False positive when array is returned
public class AvoidInstantiatingArraysInLoops {
    public int[] test() {
        for (int i = 0; i < 10; i++) {
            return new int[] { i };
        }

        for (int i = 0; i < 10; i++) {
            int[] a = new int[] { i };
            break;
        }
    }
}
```
23. This is a positive test case
```java
// False positive when converting collection to array
import java.util.ArrayList;
import java.util.List;

public class AvoidInsantiatingArraysInLoops {
    public void test() {
        List<String> data = new ArrayList<>();

        for (String arg : args) {
            this.consume(data.toArray(new String[0]));
        }
    }

    private void consume(String[] array) { }
}
```


The checker code framework(you must conform to):
```java
package net.sourceforge.pmd.lang.java.rule.performance;
import net.sourceforge.pmd.lang.java.rule.AbstractJavaRulechainRule;
import net.sourceforge.pmd.lang.java.ast.*;
import net.sourceforge.pmd.lang.java.ast.internal.*;
import net.sourceforge.pmd.lang.java.types.*;
import net.sourceforge.pmd.lang.java.symbols.*;
import net.sourceforge.pmd.lang.java.ast.JavaNode;
import net.sourceforge.pmd.lang.ast.NodeStream;
import java.util.*;
import java.lang.*;

public class AvoidInstantiatingObjectsInLoopsRule extends AbstractJavaRulechainRule {
    public rule_name() {
        super(node1_Of_AST_to_visit.class, node2_Of_AST_to_visit.class, ...);
    }
    @Override
    public Object visit(node1_Of_AST_to_visit node, Object data) {
        return super.visit(node, data);
    }
    @Override
    public Object visit(node2_Of_AST_to_visit node, Object data) {
        return super.visit(node, data);
    }
    ...
}
```
Some useful packages are already imported, if you need other packages, please import additionally.
Please give me the complete checker code including the import info, do not contain pseudocode, and do not give it step by step. No comment needed.

Below are some APIs and code snippets consisting of existing APIs, they implement specific functionality, you can selectively use them directly without changing it if you need:
1. net.sourceforge.pmd.lang.java.ast.ASTForStatement: public net.sourceforge.pmd.lang.java.ast.ASTStatement getBody(), //Returns the statement that represents the body of this loop.
2. net.sourceforge.pmd.lang.java.ast.ASTConstructorCall: public boolean equals(java.lang.Object)
3. net.sourceforge.pmd.lang.java.ast.ASTConstructorCall: public net.sourceforge.pmd.lang.java.ast.ASTClassOrInterfaceType getTypeNode()
4. net.sourceforge.pmd.lang.java.ast.ASTWhileStatement: public boolean equals(java.lang.Object)
5. net.sourceforge.pmd.lang.java.ast.ASTDoStatement: public net.sourceforge.pmd.lang.java.ast.ASTStatement getBody(), //Returns the statement that will be run while the guard evaluates to true.
6. net.sourceforge.pmd.lang.java.ast.ASTConstructorCall: public boolean isQualifiedInstanceCreation(), //Returns true if this expression begins with a primary expression. Such an expression creates an instance of inner member classes and their anonymous subclasses. For example, {@code new Outer().new Inner()} evaluates to an instance of the Inner class, which is nested inside the new instance of Outer.
7. net.sourceforge.pmd.lang.java.ast.ASTForeachStatement: public net.sourceforge.pmd.lang.java.ast.ASTVariableDeclaratorId getVarId()
8. net.sourceforge.pmd.lang.java.ast.ASTConstructorCall: public boolean isExpression(), //Always returns true. This is to allow XPath queries to query like {@code /[@Expression=true()]} to match any expression, but is useless in Java code.
9. net.sourceforge.pmd.lang.java.ast.ASTForeachStatement: public net.sourceforge.pmd.lang.java.ast.ASTStatement getBody(), //Returns the statement that represents the body of this loop.
10. net.sourceforge.pmd.lang.java.ast.ASTClassOrInterfaceDeclaration: public boolean isPublic()
11. net.sourceforge.pmd.lang.java.ast.ASTClassOrInterfaceDeclaration: public java.lang.String getSimpleName()
12. net.sourceforge.pmd.lang.java.rule.internal.TestFrameworksUtil: static public boolean isTestClass(net.sourceforge.pmd.lang.java.ast.ASTAnyTypeDeclaration)
13. net.sourceforge.pmd.lang.java.ast.ASTMethodDeclaration: public java.lang.String getName(), //Returns the simple name of the method.
14. net.sourceforge.pmd.lang.java.ast.ASTMethodDeclaration: public boolean isPublic()
15. net.sourceforge.pmd.lang.java.ast.ASTWhileStatement: public net.sourceforge.pmd.lang.document.Chars getText()
16. net.sourceforge.pmd.lang.java.ast.ASTWhileStatement: public net.sourceforge.pmd.lang.java.ast.ASTExpression getCondition()
17. net.sourceforge.pmd.lang.java.ast.ASTMethodCall: public boolean equals(java.lang.Object)
18. net.sourceforge.pmd.lang.java.ast.ASTMethodCall: public net.sourceforge.pmd.lang.java.ast.ASTExpression getQualifier()
19. net.sourceforge.pmd.lang.java.ast.ASTArrayType: public boolean isArrayType()
20. net.sourceforge.pmd.lang.java.ast.internal.JavaAstUtils: static public net.sourceforge.pmd.lang.ast.NodeStream<ASTVariableDeclaratorId> getLoopVariables(net.sourceforge.pmd.lang.java.ast.ASTForStatement)
21. net.sourceforge.pmd.lang.java.ast.ASTMethodCall: public boolean isExpression(), //Always returns true. This is to allow XPath queries to query like {@code /[@Expression=true()]} to match any expression, but is useless in Java code.
22. net.sourceforge.pmd.lang.java.ast.ASTMethodCall: public boolean isFindBoundary()
23. net.sourceforge.pmd.lang.java.ast.ASTLambdaExpression: public boolean isExpressionBody()
24. net.sourceforge.pmd.lang.java.ast.ASTExpressionStatement: public net.sourceforge.pmd.lang.java.ast.ASTExpression getExpr(), //Returns the contained expression.
25. net.sourceforge.pmd.lang.java.ast.ASTAssignmentExpression: public boolean isExpression(), //Always returns true. This is to allow XPath queries to query like {@code /[@Expression=true()]} to match any expression, but is useless in Java code.
26. net.sourceforge.pmd.lang.java.ast.ASTAssignmentExpression: public net.sourceforge.pmd.lang.java.ast.ASTExpression getRightOperand()
27. net.sourceforge.pmd.lang.java.ast.ASTMethodDeclaration: public net.sourceforge.pmd.lang.java.ast.ASTBlock getBody(), //Returns the body of this method or constructor. Returns null if this is the declaration of an abstract method.

1.  //Check whether the local variable is array type
```java
import net.sourceforge.pmd.lang.java.ast.ASTLocalVariableDeclaration;
import net.sourceforge.pmd.lang.java.ast.ASTType;
public boolean isLocalVariableArrayType(ASTLocalVariableDeclaration node) {
    ASTType type = node.getTypeNode();
    return type.getTypeMirror().isArray();
}
```
2.  //Check whether the field is array type
```java
import net.sourceforge.pmd.lang.java.ast.ASTFieldDeclaration;
import net.sourceforge.pmd.lang.java.ast.ASTType;
public boolean isFieldArrayType(ASTFieldDeclaration node) {
    ASTType type = node.getTypeNode();
    return type.getTypeMirror().isArray();
}
```
3.  //Get the return type of called method
```java
import net.sourceforge.pmd.lang.java.ast.ASTMethodCall;
import net.sourceforge.pmd.lang.java.types.JMethodSig;
import net.sourceforge.pmd.lang.java.types.JTypeMirror;
public JTypeMirror getReturnType(ASTMethodCall call) {
    JMethodSig m = call.getMethodType();
    return m.getReturnType();
}
```
4.  //Check whether the return type of called method is string
```java
import net.sourceforge.pmd.lang.java.ast.ASTMethodCall;
import net.sourceforge.pmd.lang.java.types.JMethodSig;
import net.sourceforge.pmd.lang.java.types.TypeTestUtil;
public boolean isReturnStringType(ASTMethodCall call) {
    JMethodSig m = call.getMethodType();
    return TypeTestUtil.isA(String.class, m.getReturnType());
}
```
5.  //Check whether the argument is array type
```java
import net.sourceforge.pmd.lang.java.ast.ASTMethodCall;
import net.sourceforge.pmd.lang.java.ast.ASTArgumentList;
import net.sourceforge.pmd.lang.java.ast.ASTExpression;
public boolean isMethodCallArgumentArrayType(ASTMethodCall node) {
   ASTArgumentList astArgumentList = node.getArguments();
    //select which argument to judge
    ASTExpression expression = astArgumentList.get(0);
    return expression.getTypeMirror().isArray();
}
```
6.  //Check whether the array is string type
```java
import net.sourceforge.pmd.lang.java.ast.ASTVariableDeclaratorId;
import net.sourceforge.pmd.lang.java.ast.ASTArrayType;
import net.sourceforge.pmd.lang.java.ast.ASTType;
import net.sourceforge.pmd.lang.java.ast.ASTClassOrInterfaceType;
import net.sourceforge.pmd.lang.java.types.TypeTestUtil;
public boolean isArrayStringType(ASTVariableDeclaratorId node) {
    if(node.getType().isArray()){
        ASTArrayType arrayType = (ASTArrayType)node.getTypeNode();
        ASTType astType = (ASTType) arrayType.getChild(0);
        if(astType instanceof ASTClassOrInterfaceType){
            ASTClassOrInterfaceType classOrInterfaceType = (ASTClassOrInterfaceType)astType;
            return TypeTestUtil.isA(String.class, classOrInterfaceType);
        }
    }
    return false;
}
```


Below are some edge-related APIs to help traverse abstract syntax tree, if you need, you can use them:
1. public net.sourceforge.pmd.lang.ast.NodeStream<JavaNode> children()
2. public net.sourceforge.pmd.lang.ast.NodeStream<JavaNode> children(java.lang.Class)
3. public N getChild(int i)
4. public N getFirstChild()
5. public N getLastChild()
6. public N firstChild(java.lang.Class)
7. public int getNumChildren()
8. public int getIndexInParent()
9. public net.sourceforge.pmd.lang.ast.NodeStream.DescendantNodeStream<JavaNode> descendants()
10. public net.sourceforge.pmd.lang.ast.NodeStream.DescendantNodeStream<JavaNode> descendants(java.lang.Class)
11. public net.sourceforge.pmd.lang.ast.NodeStream.DescendantNodeStream<JavaNode> descendantsOrSelf()
12. public N getParent()
13. public N getNthParent(int i)
14. public net.sourceforge.pmd.lang.ast.NodeStream<JavaNode> ancestors()
15. public net.sourceforge.pmd.lang.ast.NodeStream<JavaNode> ancestors(java.lang.Class)
16. public net.sourceforge.pmd.lang.ast.NodeStream<JavaNode> ancestorsOrSelf()
17. public N getPreviousSibling()
18. public N getNextSibling()

Please do not use the following API:


==========5轮中每一轮为第一个测试用例生成的checker===============
package net.sourceforge.pmd.lang.java.rule.performance;


import net.sourceforge.pmd.lang.java.rule.AbstractJavaRulechainRule;
import net.sourceforge.pmd.lang.java.ast. *;
import net.sourceforge.pmd.lang.java.ast.internal. *;
import net.sourceforge.pmd.lang.java.types. *;
import net.sourceforge.pmd.lang.java.symbols. *;
import net.sourceforge.pmd.lang.ast.NodeStream;
public class AvoidInstantiatingObjectsInLoopsRule extends AbstractJavaRulechainRule {

    public AvoidInstantiatingObjectsInLoopsRule() {
        super(ASTWhileStatement.class, ASTForStatement.class, ASTDoStatement.class);
    }

    @Override
    public Object visit(ASTWhileStatement node, Object data) {
        checkLoop(node, data);
        return super.visit(node, data);
    }

    @Override
    public Object visit(ASTForStatement node, Object data) {
        checkLoop(node, data);
        return super.visit(node, data);
    }

    @Override
    public Object visit(ASTDoStatement node, Object data) {
        checkLoop(node, data);
        return super.visit(node, data);
    }

    private void checkLoop(AbstractJavaNode loop, Object data) {
        if (loop.findDescendantsOfType(ASTAllocationExpression.class).size() > 0) {
            addViolation(data, loop);
        }
    }
}
第一个测试用例生成的checker开始编译
一开始编译是否通过：
False
编译错误不在预期范围内，重新生成
==========================第3轮生成checker========================
开始写checker
==========================The_first_checker_query=========================
You are an expert in writing java rule checkers and I need your help to generate a custom java rule checker in PMD tool version 7.0.0. 
I will give you a rule description and its several test cases.

The following is the description of the rule:
Rule description: New objects can not be created within loops;

The following are the test cases of the rule:
1. This is a negative test case
```java
// TEST1
public class Foo {
    public void test1() {
        for(;;) {
            String a = new String();
        }
    }
}
```
2. This is a negative test case
```java
// TEST2
public class Foo {
    public void test1() {
        while(true) {
            String a = new String();
        }
    }
}
```
3. This is a negative test case
```java
// TEST3
public class Foo {
    public void test1() {
        do {
            String a = new String();
        } while(true);
    }
}
```
4. This is a negative test case
```java
// TEST4
public class Foo {
    public void test1() {
        do {
            String a = new String();
        } while(true);
    }
}
```
5. This is a positive test case
```java
// throw new is OK
public class Foo {
    public void test1() {
        for(;;) {
            throw new Exception();
        }
    }
}
```
6. This is a positive test case
```java
// return new in loop is OK
public class Foo {
    public String test1() {
        for(;;) {
            return new String();
        }
    }
}
```
7. This is a positive test case
```java
// #278 Semi-false positive for instantiating new object in loop
public class Foo {
    public void test1() {
        while (true) {
            try {
            } catch (Exception e) {
                url = new StringBuffer();
                break;
            }
        }
    }
}
```
8. This is a positive test case
```java
// #1215 AvoidInstantiatingObjectsInLoops matches the right side of a list iteration loop
import java.util.ArrayList;
import java.io.File;

public class TestInstantiationInLoop {
    public static void main(String args[]) {
        for (String test : new ArrayList<String>()) { // facetious but simple example
            System.out.println(test);
        }
        for (String filename : new File("subdirectory").list()) { // complex but realistically conceivable (albeit exagerrated/oversimplified/rarely advisable) example
            System.out.println(filename);
        }
    }
}
```
9. This is a positive test case
```java
// [java] False positive: AvoidInstantiatingObjectsInLoops should not flag objects with different parameters or objects assigned or passed as parameters #2207
import java.awt.Dimension;

public class PMDDemo {
    public static void main(final String[] args) {
        final Dimension[] arr = new Dimension[10];
        for (int i = 0; i < arr.length; i++) {
            arr[i] = new Dimension(i, i); // rule violation here
        }
    }
}
```
10. This is a positive test case
```java
// False positive when assigning to a list/array (see #2207 and #1043)
import java.util.Collection;
import java.util.ArrayList;

public class PMDDemo {
    public void checkArray() {
        Car[] cars = new Car[3];
        for(int i = 0; i < cars.length; ++i) {
           cars[i] = new Car();
        }
    }
    public void checkCollection() {
        Collection<Car> cars = new ArrayList<>();
        for(int i = 0; i < 3; ++i) {
           cars.add(new Car());
        }
    }

    private static class Car {}
}
```
11. This is a negative test case
```java
// False negative with break in other for-loop
import java.util.function.Function;
import java.util.List;
import java.util.SortedSet;
import java.util.TreeSet;

public class Message {
    private List<Function<Message, Boolean>> filters;

    public Message(Message message) {}

    private SortedSet<Message> getFilteredMessages(List<Message> messages) {
        final SortedSet<Message> result = new TreeSet<>(messages);
        for (Message element : messages) {
            Message event = new Message(element);
            for (Function<Message, Boolean> filter : filters) {
                if (!filter.apply(event)) {
                    result.remove(element);
                    break;
                }
            }
        }
        return result;
    }
}
```
12. This is a negative test case
```java
// Instantiation in loop condition
public class Foo {
    public void test1() {
        while(new String().length() > 0) {
        }
    }
}
```
13. This is a negative test case
```java
// false negative in anonymous classes
public class Sample {
    private static class Inner {
        private void baz() {
            for(;;) {
                String a = new String();
            }
        }
    }

    public void foo() {
        Sample anonymousClass = new Sample() {
            void bar() {
                for(;;) {
                    String a = new String();
                }
            }
        };
    }
}
```
14. This is a positive test case
```java
// false positive with list
import java.util.Collection;
import java.util.ArrayList;

public class Sample {
    public Collection<Car> checkCollection() {
        Collection<Car> thisIsACar = new ArrayList<>();
        for(int i = 0; i < 3; ++i) {
            thisIsACar.add(new Car());
        }
        return thisIsACar;
    }

    private static class Car {
    }
}
```
15. This is a negative test case
```java
// Collections with unresolved type
// Types are unresolved
//import java.util.Collection;
//import java.util.ArrayList;

public class Sample {
    public Collection<Car> checkCollection() {
        Collection<Car> thisIsACar = new ArrayList<>();
        for(int i = 0; i < 3; ++i) {
            thisIsACar.add(new Car());
        }
        return thisIsACar;
    }

    private static class Car {
    }
}
```
16. This is a negative test case
```java
// False negative with array allocations within loops
public class AvoidInstantiatingArraysInLoops {
    public static void main(String[] args) {
        for (String arg : args) {
            String[] copy = new String[] { arg };
        }
    }
}
```
17. This is a positive test case
```java
// False positive with for-each loop over new array
public class AvoidInstantiatingArrayInLoops {
    public static void main(String[] args) {
        for (String configName : new String[] {"config", "test"}) {
            System.out.println(configName);
        }
    }
}
```
18. This is a positive test case
```java
// False positive with adding to a collection/array field
import java.util.ArrayList;
import java.util.List;

public class AvoidInstantiatingObjectsInLoops {
    private List<String> field = new ArrayList<>();
    private String[] arrayField = new String[10];

    public static void main(String[] args) {
        for (String arg : args) {
            this.field.add(new String(arg));
        }
        for (int i = 0; i < args.length; i++) {
            this.arrayField[i] = new String(args[i]);
        }
    }
}
```
19. This is a positive test case
```java
// False positive with adding wrapped new arrays to collection
import java.nio.ByteBuffer;
import java.nio.charset.StandardCharsets;
import java.util.ArrayList;
import java.util.List;

public class AvoidInstantiatingObjectsInLoops {
    public void testBytes(String s) {
        byte[] bytes = s.getBytes(StandardCharsets.UTF_8);
        List<ByteBuffer> buffers = new ArrayList<>();
        for (byte b : bytes) {
            buffers.add(ByteBuffer.wrap(new byte[]{b}));
        }
    }
}
```
20. This is a positive test case
```java
// False positive with temporary object assigned to an array
public class AvoidInstantiatingObjectsInLoops {
    public static void main(String[] args) {
        String[] data = new String[10];
        for (int i = 0; i < data.length; i++) {
            data[i] = new StringBuilder().append("foo").toString();
        }
    }
}
```
21. This is a positive test case
```java
// False positive with array allocation and assignment
public class AvoidInstantiatingArraysInLoops {
    public static void main(String[] args) {
        int[][] arr = new int[10];
        for (int i = 0; i < 10; i++) {
            arr[i] = new int[] { i };
        }
    }
}
```
22. This is a positive test case
```java
// False positive when array is returned
public class AvoidInstantiatingArraysInLoops {
    public int[] test() {
        for (int i = 0; i < 10; i++) {
            return new int[] { i };
        }

        for (int i = 0; i < 10; i++) {
            int[] a = new int[] { i };
            break;
        }
    }
}
```
23. This is a positive test case
```java
// False positive when converting collection to array
import java.util.ArrayList;
import java.util.List;

public class AvoidInsantiatingArraysInLoops {
    public void test() {
        List<String> data = new ArrayList<>();

        for (String arg : args) {
            this.consume(data.toArray(new String[0]));
        }
    }

    private void consume(String[] array) { }
}
```


The checker code framework(you must conform to):
```java
package net.sourceforge.pmd.lang.java.rule.performance;
import net.sourceforge.pmd.lang.java.rule.AbstractJavaRulechainRule;
import net.sourceforge.pmd.lang.java.ast.*;
import net.sourceforge.pmd.lang.java.ast.internal.*;
import net.sourceforge.pmd.lang.java.types.*;
import net.sourceforge.pmd.lang.java.symbols.*;
import net.sourceforge.pmd.lang.java.ast.JavaNode;
import net.sourceforge.pmd.lang.ast.NodeStream;
import java.util.*;
import java.lang.*;

public class AvoidInstantiatingObjectsInLoopsRule extends AbstractJavaRulechainRule {
    public rule_name() {
        super(node1_Of_AST_to_visit.class, node2_Of_AST_to_visit.class, ...);
    }
    @Override
    public Object visit(node1_Of_AST_to_visit node, Object data) {
        return super.visit(node, data);
    }
    @Override
    public Object visit(node2_Of_AST_to_visit node, Object data) {
        return super.visit(node, data);
    }
    ...
}
```
Some useful packages are already imported, if you need other packages, please import additionally.
Please give me the complete checker code including the import info, do not contain pseudocode, and do not give it step by step. No comment needed.

Below are some APIs and code snippets consisting of existing APIs, they implement specific functionality, you can selectively use them directly without changing it if you need:
1. net.sourceforge.pmd.lang.java.ast.ASTForStatement: public net.sourceforge.pmd.lang.java.ast.ASTStatement getBody(), //Returns the statement that represents the body of this loop.
2. net.sourceforge.pmd.lang.java.ast.ASTConstructorCall: public boolean equals(java.lang.Object)
3. net.sourceforge.pmd.lang.java.ast.ASTConstructorCall: public net.sourceforge.pmd.lang.java.ast.ASTClassOrInterfaceType getTypeNode()
4. net.sourceforge.pmd.lang.java.ast.ASTWhileStatement: public boolean equals(java.lang.Object)
5. net.sourceforge.pmd.lang.java.ast.ASTDoStatement: public net.sourceforge.pmd.lang.java.ast.ASTStatement getBody(), //Returns the statement that will be run while the guard evaluates to true.
6. net.sourceforge.pmd.lang.java.ast.ASTConstructorCall: public boolean isQualifiedInstanceCreation(), //Returns true if this expression begins with a primary expression. Such an expression creates an instance of inner member classes and their anonymous subclasses. For example, {@code new Outer().new Inner()} evaluates to an instance of the Inner class, which is nested inside the new instance of Outer.
7. net.sourceforge.pmd.lang.java.ast.ASTForeachStatement: public net.sourceforge.pmd.lang.java.ast.ASTVariableDeclaratorId getVarId()
8. net.sourceforge.pmd.lang.java.ast.ASTConstructorCall: public boolean isExpression(), //Always returns true. This is to allow XPath queries to query like {@code /[@Expression=true()]} to match any expression, but is useless in Java code.
9. net.sourceforge.pmd.lang.java.ast.ASTForeachStatement: public net.sourceforge.pmd.lang.java.ast.ASTStatement getBody(), //Returns the statement that represents the body of this loop.
10. net.sourceforge.pmd.lang.java.ast.ASTClassOrInterfaceDeclaration: public boolean isPublic()
11. net.sourceforge.pmd.lang.java.ast.ASTClassOrInterfaceDeclaration: public java.lang.String getSimpleName()
12. net.sourceforge.pmd.lang.java.rule.internal.TestFrameworksUtil: static public boolean isTestClass(net.sourceforge.pmd.lang.java.ast.ASTAnyTypeDeclaration)
13. net.sourceforge.pmd.lang.java.ast.ASTMethodDeclaration: public java.lang.String getName(), //Returns the simple name of the method.
14. net.sourceforge.pmd.lang.java.ast.ASTMethodDeclaration: public boolean isPublic()
15. net.sourceforge.pmd.lang.java.ast.ASTWhileStatement: public net.sourceforge.pmd.lang.document.Chars getText()
16. net.sourceforge.pmd.lang.java.ast.ASTWhileStatement: public net.sourceforge.pmd.lang.java.ast.ASTExpression getCondition()
17. net.sourceforge.pmd.lang.java.ast.ASTMethodCall: public boolean equals(java.lang.Object)
18. net.sourceforge.pmd.lang.java.ast.ASTMethodCall: public net.sourceforge.pmd.lang.java.ast.ASTExpression getQualifier()
19. net.sourceforge.pmd.lang.java.ast.ASTArrayType: public boolean isArrayType()
20. net.sourceforge.pmd.lang.java.ast.internal.JavaAstUtils: static public net.sourceforge.pmd.lang.ast.NodeStream<ASTVariableDeclaratorId> getLoopVariables(net.sourceforge.pmd.lang.java.ast.ASTForStatement)
21. net.sourceforge.pmd.lang.java.ast.ASTMethodCall: public boolean isExpression(), //Always returns true. This is to allow XPath queries to query like {@code /[@Expression=true()]} to match any expression, but is useless in Java code.
22. net.sourceforge.pmd.lang.java.ast.ASTMethodCall: public boolean isFindBoundary()
23. net.sourceforge.pmd.lang.java.ast.ASTLambdaExpression: public boolean isExpressionBody()
24. net.sourceforge.pmd.lang.java.ast.ASTExpressionStatement: public net.sourceforge.pmd.lang.java.ast.ASTExpression getExpr(), //Returns the contained expression.
25. net.sourceforge.pmd.lang.java.ast.ASTAssignmentExpression: public boolean isExpression(), //Always returns true. This is to allow XPath queries to query like {@code /[@Expression=true()]} to match any expression, but is useless in Java code.
26. net.sourceforge.pmd.lang.java.ast.ASTAssignmentExpression: public net.sourceforge.pmd.lang.java.ast.ASTExpression getRightOperand()
27. net.sourceforge.pmd.lang.java.ast.ASTMethodDeclaration: public net.sourceforge.pmd.lang.java.ast.ASTBlock getBody(), //Returns the body of this method or constructor. Returns null if this is the declaration of an abstract method.

1.  //Check whether the local variable is array type
```java
import net.sourceforge.pmd.lang.java.ast.ASTLocalVariableDeclaration;
import net.sourceforge.pmd.lang.java.ast.ASTType;
public boolean isLocalVariableArrayType(ASTLocalVariableDeclaration node) {
    ASTType type = node.getTypeNode();
    return type.getTypeMirror().isArray();
}
```
2.  //Check whether the field is array type
```java
import net.sourceforge.pmd.lang.java.ast.ASTFieldDeclaration;
import net.sourceforge.pmd.lang.java.ast.ASTType;
public boolean isFieldArrayType(ASTFieldDeclaration node) {
    ASTType type = node.getTypeNode();
    return type.getTypeMirror().isArray();
}
```
3.  //Get the return type of called method
```java
import net.sourceforge.pmd.lang.java.ast.ASTMethodCall;
import net.sourceforge.pmd.lang.java.types.JMethodSig;
import net.sourceforge.pmd.lang.java.types.JTypeMirror;
public JTypeMirror getReturnType(ASTMethodCall call) {
    JMethodSig m = call.getMethodType();
    return m.getReturnType();
}
```
4.  //Check whether the return type of called method is string
```java
import net.sourceforge.pmd.lang.java.ast.ASTMethodCall;
import net.sourceforge.pmd.lang.java.types.JMethodSig;
import net.sourceforge.pmd.lang.java.types.TypeTestUtil;
public boolean isReturnStringType(ASTMethodCall call) {
    JMethodSig m = call.getMethodType();
    return TypeTestUtil.isA(String.class, m.getReturnType());
}
```
5.  //Check whether the argument is array type
```java
import net.sourceforge.pmd.lang.java.ast.ASTMethodCall;
import net.sourceforge.pmd.lang.java.ast.ASTArgumentList;
import net.sourceforge.pmd.lang.java.ast.ASTExpression;
public boolean isMethodCallArgumentArrayType(ASTMethodCall node) {
   ASTArgumentList astArgumentList = node.getArguments();
    //select which argument to judge
    ASTExpression expression = astArgumentList.get(0);
    return expression.getTypeMirror().isArray();
}
```
6.  //Check whether the array is string type
```java
import net.sourceforge.pmd.lang.java.ast.ASTVariableDeclaratorId;
import net.sourceforge.pmd.lang.java.ast.ASTArrayType;
import net.sourceforge.pmd.lang.java.ast.ASTType;
import net.sourceforge.pmd.lang.java.ast.ASTClassOrInterfaceType;
import net.sourceforge.pmd.lang.java.types.TypeTestUtil;
public boolean isArrayStringType(ASTVariableDeclaratorId node) {
    if(node.getType().isArray()){
        ASTArrayType arrayType = (ASTArrayType)node.getTypeNode();
        ASTType astType = (ASTType) arrayType.getChild(0);
        if(astType instanceof ASTClassOrInterfaceType){
            ASTClassOrInterfaceType classOrInterfaceType = (ASTClassOrInterfaceType)astType;
            return TypeTestUtil.isA(String.class, classOrInterfaceType);
        }
    }
    return false;
}
```


Below are some edge-related APIs to help traverse abstract syntax tree, if you need, you can use them:
1. public net.sourceforge.pmd.lang.ast.NodeStream<JavaNode> children()
2. public net.sourceforge.pmd.lang.ast.NodeStream<JavaNode> children(java.lang.Class)
3. public N getChild(int i)
4. public N getFirstChild()
5. public N getLastChild()
6. public N firstChild(java.lang.Class)
7. public int getNumChildren()
8. public int getIndexInParent()
9. public net.sourceforge.pmd.lang.ast.NodeStream.DescendantNodeStream<JavaNode> descendants()
10. public net.sourceforge.pmd.lang.ast.NodeStream.DescendantNodeStream<JavaNode> descendants(java.lang.Class)
11. public net.sourceforge.pmd.lang.ast.NodeStream.DescendantNodeStream<JavaNode> descendantsOrSelf()
12. public N getParent()
13. public N getNthParent(int i)
14. public net.sourceforge.pmd.lang.ast.NodeStream<JavaNode> ancestors()
15. public net.sourceforge.pmd.lang.ast.NodeStream<JavaNode> ancestors(java.lang.Class)
16. public net.sourceforge.pmd.lang.ast.NodeStream<JavaNode> ancestorsOrSelf()
17. public N getPreviousSibling()
18. public N getNextSibling()

Please do not use the following API:


==========5轮中每一轮为第一个测试用例生成的checker===============
package net.sourceforge.pmd.lang.java.rule.performance;


import net.sourceforge.pmd.lang.java.rule.AbstractJavaRulechainRule;
import net.sourceforge.pmd.lang.java.ast. *;
import net.sourceforge.pmd.lang.java.ast.internal. *;
import net.sourceforge.pmd.lang.java.types. *;
import net.sourceforge.pmd.lang.java.symbols. *;
import net.sourceforge.pmd.lang.ast.NodeStream;
public class AvoidInstantiatingObjectsInLoopsRule extends AbstractJavaRulechainRule {
    public AvoidInstantiatingObjectsInLoopsRule() {
        super(ASTForStatement.class, ASTWhileStatement.class, ASTDoStatement.class);
    }

    @Override
    public Object visit(ASTForStatement node, Object data) {
        return visitLoop(node, data);
    }

    @Override
    public Object visit(ASTWhileStatement node, Object data) {
        return visitLoop(node, data);
    }

    @Override
    public Object visit(ASTDoStatement node, Object data) {
        return visitLoop(node, data);
    }

    private Object visitLoop(Node node, Object data) {
        if (Helper.isAllocation(node)) {
            ASTAllocationExpression alloc = (ASTAllocationExpression) node;
            if (!alloc.isAnonymousInnerClass()) {
                addViolation(data, node);
            }
        }
        return super.visit(node, data);
    }
}
第一个测试用例生成的checker开始编译
一开始编译是否通过：
False
编译错误不在预期范围内，重新生成
==========================第4轮生成checker========================
开始写checker
==========================The_first_checker_query=========================
You are an expert in writing java rule checkers and I need your help to generate a custom java rule checker in PMD tool version 7.0.0. 
I will give you a rule description and its several test cases.

The following is the description of the rule:
Rule description: New objects can not be created within loops;

The following are the test cases of the rule:
1. This is a negative test case
```java
// TEST1
public class Foo {
    public void test1() {
        for(;;) {
            String a = new String();
        }
    }
}
```
2. This is a negative test case
```java
// TEST2
public class Foo {
    public void test1() {
        while(true) {
            String a = new String();
        }
    }
}
```
3. This is a negative test case
```java
// TEST3
public class Foo {
    public void test1() {
        do {
            String a = new String();
        } while(true);
    }
}
```
4. This is a negative test case
```java
// TEST4
public class Foo {
    public void test1() {
        do {
            String a = new String();
        } while(true);
    }
}
```
5. This is a positive test case
```java
// throw new is OK
public class Foo {
    public void test1() {
        for(;;) {
            throw new Exception();
        }
    }
}
```
6. This is a positive test case
```java
// return new in loop is OK
public class Foo {
    public String test1() {
        for(;;) {
            return new String();
        }
    }
}
```
7. This is a positive test case
```java
// #278 Semi-false positive for instantiating new object in loop
public class Foo {
    public void test1() {
        while (true) {
            try {
            } catch (Exception e) {
                url = new StringBuffer();
                break;
            }
        }
    }
}
```
8. This is a positive test case
```java
// #1215 AvoidInstantiatingObjectsInLoops matches the right side of a list iteration loop
import java.util.ArrayList;
import java.io.File;

public class TestInstantiationInLoop {
    public static void main(String args[]) {
        for (String test : new ArrayList<String>()) { // facetious but simple example
            System.out.println(test);
        }
        for (String filename : new File("subdirectory").list()) { // complex but realistically conceivable (albeit exagerrated/oversimplified/rarely advisable) example
            System.out.println(filename);
        }
    }
}
```
9. This is a positive test case
```java
// [java] False positive: AvoidInstantiatingObjectsInLoops should not flag objects with different parameters or objects assigned or passed as parameters #2207
import java.awt.Dimension;

public class PMDDemo {
    public static void main(final String[] args) {
        final Dimension[] arr = new Dimension[10];
        for (int i = 0; i < arr.length; i++) {
            arr[i] = new Dimension(i, i); // rule violation here
        }
    }
}
```
10. This is a positive test case
```java
// False positive when assigning to a list/array (see #2207 and #1043)
import java.util.Collection;
import java.util.ArrayList;

public class PMDDemo {
    public void checkArray() {
        Car[] cars = new Car[3];
        for(int i = 0; i < cars.length; ++i) {
           cars[i] = new Car();
        }
    }
    public void checkCollection() {
        Collection<Car> cars = new ArrayList<>();
        for(int i = 0; i < 3; ++i) {
           cars.add(new Car());
        }
    }

    private static class Car {}
}
```
11. This is a negative test case
```java
// False negative with break in other for-loop
import java.util.function.Function;
import java.util.List;
import java.util.SortedSet;
import java.util.TreeSet;

public class Message {
    private List<Function<Message, Boolean>> filters;

    public Message(Message message) {}

    private SortedSet<Message> getFilteredMessages(List<Message> messages) {
        final SortedSet<Message> result = new TreeSet<>(messages);
        for (Message element : messages) {
            Message event = new Message(element);
            for (Function<Message, Boolean> filter : filters) {
                if (!filter.apply(event)) {
                    result.remove(element);
                    break;
                }
            }
        }
        return result;
    }
}
```
12. This is a negative test case
```java
// Instantiation in loop condition
public class Foo {
    public void test1() {
        while(new String().length() > 0) {
        }
    }
}
```
13. This is a negative test case
```java
// false negative in anonymous classes
public class Sample {
    private static class Inner {
        private void baz() {
            for(;;) {
                String a = new String();
            }
        }
    }

    public void foo() {
        Sample anonymousClass = new Sample() {
            void bar() {
                for(;;) {
                    String a = new String();
                }
            }
        };
    }
}
```
14. This is a positive test case
```java
// false positive with list
import java.util.Collection;
import java.util.ArrayList;

public class Sample {
    public Collection<Car> checkCollection() {
        Collection<Car> thisIsACar = new ArrayList<>();
        for(int i = 0; i < 3; ++i) {
            thisIsACar.add(new Car());
        }
        return thisIsACar;
    }

    private static class Car {
    }
}
```
15. This is a negative test case
```java
// Collections with unresolved type
// Types are unresolved
//import java.util.Collection;
//import java.util.ArrayList;

public class Sample {
    public Collection<Car> checkCollection() {
        Collection<Car> thisIsACar = new ArrayList<>();
        for(int i = 0; i < 3; ++i) {
            thisIsACar.add(new Car());
        }
        return thisIsACar;
    }

    private static class Car {
    }
}
```
16. This is a negative test case
```java
// False negative with array allocations within loops
public class AvoidInstantiatingArraysInLoops {
    public static void main(String[] args) {
        for (String arg : args) {
            String[] copy = new String[] { arg };
        }
    }
}
```
17. This is a positive test case
```java
// False positive with for-each loop over new array
public class AvoidInstantiatingArrayInLoops {
    public static void main(String[] args) {
        for (String configName : new String[] {"config", "test"}) {
            System.out.println(configName);
        }
    }
}
```
18. This is a positive test case
```java
// False positive with adding to a collection/array field
import java.util.ArrayList;
import java.util.List;

public class AvoidInstantiatingObjectsInLoops {
    private List<String> field = new ArrayList<>();
    private String[] arrayField = new String[10];

    public static void main(String[] args) {
        for (String arg : args) {
            this.field.add(new String(arg));
        }
        for (int i = 0; i < args.length; i++) {
            this.arrayField[i] = new String(args[i]);
        }
    }
}
```
19. This is a positive test case
```java
// False positive with adding wrapped new arrays to collection
import java.nio.ByteBuffer;
import java.nio.charset.StandardCharsets;
import java.util.ArrayList;
import java.util.List;

public class AvoidInstantiatingObjectsInLoops {
    public void testBytes(String s) {
        byte[] bytes = s.getBytes(StandardCharsets.UTF_8);
        List<ByteBuffer> buffers = new ArrayList<>();
        for (byte b : bytes) {
            buffers.add(ByteBuffer.wrap(new byte[]{b}));
        }
    }
}
```
20. This is a positive test case
```java
// False positive with temporary object assigned to an array
public class AvoidInstantiatingObjectsInLoops {
    public static void main(String[] args) {
        String[] data = new String[10];
        for (int i = 0; i < data.length; i++) {
            data[i] = new StringBuilder().append("foo").toString();
        }
    }
}
```
21. This is a positive test case
```java
// False positive with array allocation and assignment
public class AvoidInstantiatingArraysInLoops {
    public static void main(String[] args) {
        int[][] arr = new int[10];
        for (int i = 0; i < 10; i++) {
            arr[i] = new int[] { i };
        }
    }
}
```
22. This is a positive test case
```java
// False positive when array is returned
public class AvoidInstantiatingArraysInLoops {
    public int[] test() {
        for (int i = 0; i < 10; i++) {
            return new int[] { i };
        }

        for (int i = 0; i < 10; i++) {
            int[] a = new int[] { i };
            break;
        }
    }
}
```
23. This is a positive test case
```java
// False positive when converting collection to array
import java.util.ArrayList;
import java.util.List;

public class AvoidInsantiatingArraysInLoops {
    public void test() {
        List<String> data = new ArrayList<>();

        for (String arg : args) {
            this.consume(data.toArray(new String[0]));
        }
    }

    private void consume(String[] array) { }
}
```


The checker code framework(you must conform to):
```java
package net.sourceforge.pmd.lang.java.rule.performance;
import net.sourceforge.pmd.lang.java.rule.AbstractJavaRulechainRule;
import net.sourceforge.pmd.lang.java.ast.*;
import net.sourceforge.pmd.lang.java.ast.internal.*;
import net.sourceforge.pmd.lang.java.types.*;
import net.sourceforge.pmd.lang.java.symbols.*;
import net.sourceforge.pmd.lang.java.ast.JavaNode;
import net.sourceforge.pmd.lang.ast.NodeStream;
import java.util.*;
import java.lang.*;

public class AvoidInstantiatingObjectsInLoopsRule extends AbstractJavaRulechainRule {
    public rule_name() {
        super(node1_Of_AST_to_visit.class, node2_Of_AST_to_visit.class, ...);
    }
    @Override
    public Object visit(node1_Of_AST_to_visit node, Object data) {
        return super.visit(node, data);
    }
    @Override
    public Object visit(node2_Of_AST_to_visit node, Object data) {
        return super.visit(node, data);
    }
    ...
}
```
Some useful packages are already imported, if you need other packages, please import additionally.
Please give me the complete checker code including the import info, do not contain pseudocode, and do not give it step by step. No comment needed.

Below are some APIs and code snippets consisting of existing APIs, they implement specific functionality, you can selectively use them directly without changing it if you need:
1. net.sourceforge.pmd.lang.java.ast.ASTForStatement: public net.sourceforge.pmd.lang.java.ast.ASTStatement getBody(), //Returns the statement that represents the body of this loop.
2. net.sourceforge.pmd.lang.java.ast.ASTConstructorCall: public boolean equals(java.lang.Object)
3. net.sourceforge.pmd.lang.java.ast.ASTConstructorCall: public net.sourceforge.pmd.lang.java.ast.ASTClassOrInterfaceType getTypeNode()
4. net.sourceforge.pmd.lang.java.ast.ASTWhileStatement: public boolean equals(java.lang.Object)
5. net.sourceforge.pmd.lang.java.ast.ASTDoStatement: public net.sourceforge.pmd.lang.java.ast.ASTStatement getBody(), //Returns the statement that will be run while the guard evaluates to true.
6. net.sourceforge.pmd.lang.java.ast.ASTConstructorCall: public boolean isQualifiedInstanceCreation(), //Returns true if this expression begins with a primary expression. Such an expression creates an instance of inner member classes and their anonymous subclasses. For example, {@code new Outer().new Inner()} evaluates to an instance of the Inner class, which is nested inside the new instance of Outer.
7. net.sourceforge.pmd.lang.java.ast.ASTForeachStatement: public net.sourceforge.pmd.lang.java.ast.ASTVariableDeclaratorId getVarId()
8. net.sourceforge.pmd.lang.java.ast.ASTConstructorCall: public boolean isExpression(), //Always returns true. This is to allow XPath queries to query like {@code /[@Expression=true()]} to match any expression, but is useless in Java code.
9. net.sourceforge.pmd.lang.java.ast.ASTForeachStatement: public net.sourceforge.pmd.lang.java.ast.ASTStatement getBody(), //Returns the statement that represents the body of this loop.
10. net.sourceforge.pmd.lang.java.ast.ASTClassOrInterfaceDeclaration: public boolean isPublic()
11. net.sourceforge.pmd.lang.java.ast.ASTClassOrInterfaceDeclaration: public java.lang.String getSimpleName()
12. net.sourceforge.pmd.lang.java.rule.internal.TestFrameworksUtil: static public boolean isTestClass(net.sourceforge.pmd.lang.java.ast.ASTAnyTypeDeclaration)
13. net.sourceforge.pmd.lang.java.ast.ASTMethodDeclaration: public java.lang.String getName(), //Returns the simple name of the method.
14. net.sourceforge.pmd.lang.java.ast.ASTMethodDeclaration: public boolean isPublic()
15. net.sourceforge.pmd.lang.java.ast.ASTWhileStatement: public net.sourceforge.pmd.lang.document.Chars getText()
16. net.sourceforge.pmd.lang.java.ast.ASTWhileStatement: public net.sourceforge.pmd.lang.java.ast.ASTExpression getCondition()
17. net.sourceforge.pmd.lang.java.ast.ASTMethodCall: public boolean equals(java.lang.Object)
18. net.sourceforge.pmd.lang.java.ast.ASTMethodCall: public net.sourceforge.pmd.lang.java.ast.ASTExpression getQualifier()
19. net.sourceforge.pmd.lang.java.ast.ASTArrayType: public boolean isArrayType()
20. net.sourceforge.pmd.lang.java.ast.internal.JavaAstUtils: static public net.sourceforge.pmd.lang.ast.NodeStream<ASTVariableDeclaratorId> getLoopVariables(net.sourceforge.pmd.lang.java.ast.ASTForStatement)
21. net.sourceforge.pmd.lang.java.ast.ASTMethodCall: public boolean isExpression(), //Always returns true. This is to allow XPath queries to query like {@code /[@Expression=true()]} to match any expression, but is useless in Java code.
22. net.sourceforge.pmd.lang.java.ast.ASTMethodCall: public boolean isFindBoundary()
23. net.sourceforge.pmd.lang.java.ast.ASTLambdaExpression: public boolean isExpressionBody()
24. net.sourceforge.pmd.lang.java.ast.ASTExpressionStatement: public net.sourceforge.pmd.lang.java.ast.ASTExpression getExpr(), //Returns the contained expression.
25. net.sourceforge.pmd.lang.java.ast.ASTAssignmentExpression: public boolean isExpression(), //Always returns true. This is to allow XPath queries to query like {@code /[@Expression=true()]} to match any expression, but is useless in Java code.
26. net.sourceforge.pmd.lang.java.ast.ASTAssignmentExpression: public net.sourceforge.pmd.lang.java.ast.ASTExpression getRightOperand()
27. net.sourceforge.pmd.lang.java.ast.ASTMethodDeclaration: public net.sourceforge.pmd.lang.java.ast.ASTBlock getBody(), //Returns the body of this method or constructor. Returns null if this is the declaration of an abstract method.

1.  //Check whether the local variable is array type
```java
import net.sourceforge.pmd.lang.java.ast.ASTLocalVariableDeclaration;
import net.sourceforge.pmd.lang.java.ast.ASTType;
public boolean isLocalVariableArrayType(ASTLocalVariableDeclaration node) {
    ASTType type = node.getTypeNode();
    return type.getTypeMirror().isArray();
}
```
2.  //Check whether the field is array type
```java
import net.sourceforge.pmd.lang.java.ast.ASTFieldDeclaration;
import net.sourceforge.pmd.lang.java.ast.ASTType;
public boolean isFieldArrayType(ASTFieldDeclaration node) {
    ASTType type = node.getTypeNode();
    return type.getTypeMirror().isArray();
}
```
3.  //Get the return type of called method
```java
import net.sourceforge.pmd.lang.java.ast.ASTMethodCall;
import net.sourceforge.pmd.lang.java.types.JMethodSig;
import net.sourceforge.pmd.lang.java.types.JTypeMirror;
public JTypeMirror getReturnType(ASTMethodCall call) {
    JMethodSig m = call.getMethodType();
    return m.getReturnType();
}
```
4.  //Check whether the return type of called method is string
```java
import net.sourceforge.pmd.lang.java.ast.ASTMethodCall;
import net.sourceforge.pmd.lang.java.types.JMethodSig;
import net.sourceforge.pmd.lang.java.types.TypeTestUtil;
public boolean isReturnStringType(ASTMethodCall call) {
    JMethodSig m = call.getMethodType();
    return TypeTestUtil.isA(String.class, m.getReturnType());
}
```
5.  //Check whether the argument is array type
```java
import net.sourceforge.pmd.lang.java.ast.ASTMethodCall;
import net.sourceforge.pmd.lang.java.ast.ASTArgumentList;
import net.sourceforge.pmd.lang.java.ast.ASTExpression;
public boolean isMethodCallArgumentArrayType(ASTMethodCall node) {
   ASTArgumentList astArgumentList = node.getArguments();
    //select which argument to judge
    ASTExpression expression = astArgumentList.get(0);
    return expression.getTypeMirror().isArray();
}
```
6.  //Check whether the array is string type
```java
import net.sourceforge.pmd.lang.java.ast.ASTVariableDeclaratorId;
import net.sourceforge.pmd.lang.java.ast.ASTArrayType;
import net.sourceforge.pmd.lang.java.ast.ASTType;
import net.sourceforge.pmd.lang.java.ast.ASTClassOrInterfaceType;
import net.sourceforge.pmd.lang.java.types.TypeTestUtil;
public boolean isArrayStringType(ASTVariableDeclaratorId node) {
    if(node.getType().isArray()){
        ASTArrayType arrayType = (ASTArrayType)node.getTypeNode();
        ASTType astType = (ASTType) arrayType.getChild(0);
        if(astType instanceof ASTClassOrInterfaceType){
            ASTClassOrInterfaceType classOrInterfaceType = (ASTClassOrInterfaceType)astType;
            return TypeTestUtil.isA(String.class, classOrInterfaceType);
        }
    }
    return false;
}
```


Below are some edge-related APIs to help traverse abstract syntax tree, if you need, you can use them:
1. public net.sourceforge.pmd.lang.ast.NodeStream<JavaNode> children()
2. public net.sourceforge.pmd.lang.ast.NodeStream<JavaNode> children(java.lang.Class)
3. public N getChild(int i)
4. public N getFirstChild()
5. public N getLastChild()
6. public N firstChild(java.lang.Class)
7. public int getNumChildren()
8. public int getIndexInParent()
9. public net.sourceforge.pmd.lang.ast.NodeStream.DescendantNodeStream<JavaNode> descendants()
10. public net.sourceforge.pmd.lang.ast.NodeStream.DescendantNodeStream<JavaNode> descendants(java.lang.Class)
11. public net.sourceforge.pmd.lang.ast.NodeStream.DescendantNodeStream<JavaNode> descendantsOrSelf()
12. public N getParent()
13. public N getNthParent(int i)
14. public net.sourceforge.pmd.lang.ast.NodeStream<JavaNode> ancestors()
15. public net.sourceforge.pmd.lang.ast.NodeStream<JavaNode> ancestors(java.lang.Class)
16. public net.sourceforge.pmd.lang.ast.NodeStream<JavaNode> ancestorsOrSelf()
17. public N getPreviousSibling()
18. public N getNextSibling()

Please do not use the following API:


==========5轮中每一轮为第一个测试用例生成的checker===============
package net.sourceforge.pmd.lang.java.rule.performance;


import net.sourceforge.pmd.lang.java.rule.AbstractJavaRulechainRule;
import net.sourceforge.pmd.lang.java.ast. *;
import net.sourceforge.pmd.lang.java.ast.internal. *;
import net.sourceforge.pmd.lang.java.types. *;
import net.sourceforge.pmd.lang.java.symbols. *;
import net.sourceforge.pmd.lang.ast.NodeStream;
public class AvoidInstantiatingObjectsInLoopsRule extends AbstractJavaRulechainRule {

    public AvoidInstantiatingObjectsInLoopsRule() {
        super(ASTAllocationExpression.class);
    }

    @Override
    public Object visit(ASTAllocationExpression node, Object data) {
        if (node.getResultType().isA(String.class)) {
            Node parent = node.jjtGetParent();
            while(parent != null) {
                if(parent instanceof ASTWhileStatement 
                || parent instanceof ASTDoStatement
                || parent instanceof ASTForStatement
                || parent instanceof ASTForeachStatement) {
                    addViolation(data, node);
                    return super.visit(node, data);
                }
                parent = parent.jjtGetParent();
            }
        }
        return super.visit(node, data);
    }
}
第一个测试用例生成的checker开始编译
一开始编译是否通过：
False
编译错误不在预期范围内，重新生成
==========================第5轮生成checker========================
开始写checker
==========================The_first_checker_query=========================
You are an expert in writing java rule checkers and I need your help to generate a custom java rule checker in PMD tool version 7.0.0. 
I will give you a rule description and its several test cases.

The following is the description of the rule:
Rule description: New objects can not be created within loops;

The following are the test cases of the rule:
1. This is a negative test case
```java
// TEST1
public class Foo {
    public void test1() {
        for(;;) {
            String a = new String();
        }
    }
}
```
2. This is a negative test case
```java
// TEST2
public class Foo {
    public void test1() {
        while(true) {
            String a = new String();
        }
    }
}
```
3. This is a negative test case
```java
// TEST3
public class Foo {
    public void test1() {
        do {
            String a = new String();
        } while(true);
    }
}
```
4. This is a negative test case
```java
// TEST4
public class Foo {
    public void test1() {
        do {
            String a = new String();
        } while(true);
    }
}
```
5. This is a positive test case
```java
// throw new is OK
public class Foo {
    public void test1() {
        for(;;) {
            throw new Exception();
        }
    }
}
```
6. This is a positive test case
```java
// return new in loop is OK
public class Foo {
    public String test1() {
        for(;;) {
            return new String();
        }
    }
}
```
7. This is a positive test case
```java
// #278 Semi-false positive for instantiating new object in loop
public class Foo {
    public void test1() {
        while (true) {
            try {
            } catch (Exception e) {
                url = new StringBuffer();
                break;
            }
        }
    }
}
```
8. This is a positive test case
```java
// #1215 AvoidInstantiatingObjectsInLoops matches the right side of a list iteration loop
import java.util.ArrayList;
import java.io.File;

public class TestInstantiationInLoop {
    public static void main(String args[]) {
        for (String test : new ArrayList<String>()) { // facetious but simple example
            System.out.println(test);
        }
        for (String filename : new File("subdirectory").list()) { // complex but realistically conceivable (albeit exagerrated/oversimplified/rarely advisable) example
            System.out.println(filename);
        }
    }
}
```
9. This is a positive test case
```java
// [java] False positive: AvoidInstantiatingObjectsInLoops should not flag objects with different parameters or objects assigned or passed as parameters #2207
import java.awt.Dimension;

public class PMDDemo {
    public static void main(final String[] args) {
        final Dimension[] arr = new Dimension[10];
        for (int i = 0; i < arr.length; i++) {
            arr[i] = new Dimension(i, i); // rule violation here
        }
    }
}
```
10. This is a positive test case
```java
// False positive when assigning to a list/array (see #2207 and #1043)
import java.util.Collection;
import java.util.ArrayList;

public class PMDDemo {
    public void checkArray() {
        Car[] cars = new Car[3];
        for(int i = 0; i < cars.length; ++i) {
           cars[i] = new Car();
        }
    }
    public void checkCollection() {
        Collection<Car> cars = new ArrayList<>();
        for(int i = 0; i < 3; ++i) {
           cars.add(new Car());
        }
    }

    private static class Car {}
}
```
11. This is a negative test case
```java
// False negative with break in other for-loop
import java.util.function.Function;
import java.util.List;
import java.util.SortedSet;
import java.util.TreeSet;

public class Message {
    private List<Function<Message, Boolean>> filters;

    public Message(Message message) {}

    private SortedSet<Message> getFilteredMessages(List<Message> messages) {
        final SortedSet<Message> result = new TreeSet<>(messages);
        for (Message element : messages) {
            Message event = new Message(element);
            for (Function<Message, Boolean> filter : filters) {
                if (!filter.apply(event)) {
                    result.remove(element);
                    break;
                }
            }
        }
        return result;
    }
}
```
12. This is a negative test case
```java
// Instantiation in loop condition
public class Foo {
    public void test1() {
        while(new String().length() > 0) {
        }
    }
}
```
13. This is a negative test case
```java
// false negative in anonymous classes
public class Sample {
    private static class Inner {
        private void baz() {
            for(;;) {
                String a = new String();
            }
        }
    }

    public void foo() {
        Sample anonymousClass = new Sample() {
            void bar() {
                for(;;) {
                    String a = new String();
                }
            }
        };
    }
}
```
14. This is a positive test case
```java
// false positive with list
import java.util.Collection;
import java.util.ArrayList;

public class Sample {
    public Collection<Car> checkCollection() {
        Collection<Car> thisIsACar = new ArrayList<>();
        for(int i = 0; i < 3; ++i) {
            thisIsACar.add(new Car());
        }
        return thisIsACar;
    }

    private static class Car {
    }
}
```
15. This is a negative test case
```java
// Collections with unresolved type
// Types are unresolved
//import java.util.Collection;
//import java.util.ArrayList;

public class Sample {
    public Collection<Car> checkCollection() {
        Collection<Car> thisIsACar = new ArrayList<>();
        for(int i = 0; i < 3; ++i) {
            thisIsACar.add(new Car());
        }
        return thisIsACar;
    }

    private static class Car {
    }
}
```
16. This is a negative test case
```java
// False negative with array allocations within loops
public class AvoidInstantiatingArraysInLoops {
    public static void main(String[] args) {
        for (String arg : args) {
            String[] copy = new String[] { arg };
        }
    }
}
```
17. This is a positive test case
```java
// False positive with for-each loop over new array
public class AvoidInstantiatingArrayInLoops {
    public static void main(String[] args) {
        for (String configName : new String[] {"config", "test"}) {
            System.out.println(configName);
        }
    }
}
```
18. This is a positive test case
```java
// False positive with adding to a collection/array field
import java.util.ArrayList;
import java.util.List;

public class AvoidInstantiatingObjectsInLoops {
    private List<String> field = new ArrayList<>();
    private String[] arrayField = new String[10];

    public static void main(String[] args) {
        for (String arg : args) {
            this.field.add(new String(arg));
        }
        for (int i = 0; i < args.length; i++) {
            this.arrayField[i] = new String(args[i]);
        }
    }
}
```
19. This is a positive test case
```java
// False positive with adding wrapped new arrays to collection
import java.nio.ByteBuffer;
import java.nio.charset.StandardCharsets;
import java.util.ArrayList;
import java.util.List;

public class AvoidInstantiatingObjectsInLoops {
    public void testBytes(String s) {
        byte[] bytes = s.getBytes(StandardCharsets.UTF_8);
        List<ByteBuffer> buffers = new ArrayList<>();
        for (byte b : bytes) {
            buffers.add(ByteBuffer.wrap(new byte[]{b}));
        }
    }
}
```
20. This is a positive test case
```java
// False positive with temporary object assigned to an array
public class AvoidInstantiatingObjectsInLoops {
    public static void main(String[] args) {
        String[] data = new String[10];
        for (int i = 0; i < data.length; i++) {
            data[i] = new StringBuilder().append("foo").toString();
        }
    }
}
```
21. This is a positive test case
```java
// False positive with array allocation and assignment
public class AvoidInstantiatingArraysInLoops {
    public static void main(String[] args) {
        int[][] arr = new int[10];
        for (int i = 0; i < 10; i++) {
            arr[i] = new int[] { i };
        }
    }
}
```
22. This is a positive test case
```java
// False positive when array is returned
public class AvoidInstantiatingArraysInLoops {
    public int[] test() {
        for (int i = 0; i < 10; i++) {
            return new int[] { i };
        }

        for (int i = 0; i < 10; i++) {
            int[] a = new int[] { i };
            break;
        }
    }
}
```
23. This is a positive test case
```java
// False positive when converting collection to array
import java.util.ArrayList;
import java.util.List;

public class AvoidInsantiatingArraysInLoops {
    public void test() {
        List<String> data = new ArrayList<>();

        for (String arg : args) {
            this.consume(data.toArray(new String[0]));
        }
    }

    private void consume(String[] array) { }
}
```


The checker code framework(you must conform to):
```java
package net.sourceforge.pmd.lang.java.rule.performance;
import net.sourceforge.pmd.lang.java.rule.AbstractJavaRulechainRule;
import net.sourceforge.pmd.lang.java.ast.*;
import net.sourceforge.pmd.lang.java.ast.internal.*;
import net.sourceforge.pmd.lang.java.types.*;
import net.sourceforge.pmd.lang.java.symbols.*;
import net.sourceforge.pmd.lang.java.ast.JavaNode;
import net.sourceforge.pmd.lang.ast.NodeStream;
import java.util.*;
import java.lang.*;

public class AvoidInstantiatingObjectsInLoopsRule extends AbstractJavaRulechainRule {
    public rule_name() {
        super(node1_Of_AST_to_visit.class, node2_Of_AST_to_visit.class, ...);
    }
    @Override
    public Object visit(node1_Of_AST_to_visit node, Object data) {
        return super.visit(node, data);
    }
    @Override
    public Object visit(node2_Of_AST_to_visit node, Object data) {
        return super.visit(node, data);
    }
    ...
}
```
Some useful packages are already imported, if you need other packages, please import additionally.
Please give me the complete checker code including the import info, do not contain pseudocode, and do not give it step by step. No comment needed.

Below are some APIs and code snippets consisting of existing APIs, they implement specific functionality, you can selectively use them directly without changing it if you need:
1. net.sourceforge.pmd.lang.java.ast.ASTForStatement: public net.sourceforge.pmd.lang.java.ast.ASTStatement getBody(), //Returns the statement that represents the body of this loop.
2. net.sourceforge.pmd.lang.java.ast.ASTConstructorCall: public boolean equals(java.lang.Object)
3. net.sourceforge.pmd.lang.java.ast.ASTConstructorCall: public net.sourceforge.pmd.lang.java.ast.ASTClassOrInterfaceType getTypeNode()
4. net.sourceforge.pmd.lang.java.ast.ASTWhileStatement: public boolean equals(java.lang.Object)
5. net.sourceforge.pmd.lang.java.ast.ASTDoStatement: public net.sourceforge.pmd.lang.java.ast.ASTStatement getBody(), //Returns the statement that will be run while the guard evaluates to true.
6. net.sourceforge.pmd.lang.java.ast.ASTConstructorCall: public boolean isQualifiedInstanceCreation(), //Returns true if this expression begins with a primary expression. Such an expression creates an instance of inner member classes and their anonymous subclasses. For example, {@code new Outer().new Inner()} evaluates to an instance of the Inner class, which is nested inside the new instance of Outer.
7. net.sourceforge.pmd.lang.java.ast.ASTForeachStatement: public net.sourceforge.pmd.lang.java.ast.ASTVariableDeclaratorId getVarId()
8. net.sourceforge.pmd.lang.java.ast.ASTConstructorCall: public boolean isExpression(), //Always returns true. This is to allow XPath queries to query like {@code /[@Expression=true()]} to match any expression, but is useless in Java code.
9. net.sourceforge.pmd.lang.java.ast.ASTForeachStatement: public net.sourceforge.pmd.lang.java.ast.ASTStatement getBody(), //Returns the statement that represents the body of this loop.
10. net.sourceforge.pmd.lang.java.ast.ASTClassOrInterfaceDeclaration: public boolean isPublic()
11. net.sourceforge.pmd.lang.java.ast.ASTClassOrInterfaceDeclaration: public java.lang.String getSimpleName()
12. net.sourceforge.pmd.lang.java.rule.internal.TestFrameworksUtil: static public boolean isTestClass(net.sourceforge.pmd.lang.java.ast.ASTAnyTypeDeclaration)
13. net.sourceforge.pmd.lang.java.ast.ASTMethodDeclaration: public java.lang.String getName(), //Returns the simple name of the method.
14. net.sourceforge.pmd.lang.java.ast.ASTMethodDeclaration: public boolean isPublic()
15. net.sourceforge.pmd.lang.java.ast.ASTWhileStatement: public net.sourceforge.pmd.lang.document.Chars getText()
16. net.sourceforge.pmd.lang.java.ast.ASTWhileStatement: public net.sourceforge.pmd.lang.java.ast.ASTExpression getCondition()
17. net.sourceforge.pmd.lang.java.ast.ASTMethodCall: public boolean equals(java.lang.Object)
18. net.sourceforge.pmd.lang.java.ast.ASTMethodCall: public net.sourceforge.pmd.lang.java.ast.ASTExpression getQualifier()
19. net.sourceforge.pmd.lang.java.ast.ASTArrayType: public boolean isArrayType()
20. net.sourceforge.pmd.lang.java.ast.internal.JavaAstUtils: static public net.sourceforge.pmd.lang.ast.NodeStream<ASTVariableDeclaratorId> getLoopVariables(net.sourceforge.pmd.lang.java.ast.ASTForStatement)
21. net.sourceforge.pmd.lang.java.ast.ASTMethodCall: public boolean isExpression(), //Always returns true. This is to allow XPath queries to query like {@code /[@Expression=true()]} to match any expression, but is useless in Java code.
22. net.sourceforge.pmd.lang.java.ast.ASTMethodCall: public boolean isFindBoundary()
23. net.sourceforge.pmd.lang.java.ast.ASTLambdaExpression: public boolean isExpressionBody()
24. net.sourceforge.pmd.lang.java.ast.ASTExpressionStatement: public net.sourceforge.pmd.lang.java.ast.ASTExpression getExpr(), //Returns the contained expression.
25. net.sourceforge.pmd.lang.java.ast.ASTAssignmentExpression: public boolean isExpression(), //Always returns true. This is to allow XPath queries to query like {@code /[@Expression=true()]} to match any expression, but is useless in Java code.
26. net.sourceforge.pmd.lang.java.ast.ASTAssignmentExpression: public net.sourceforge.pmd.lang.java.ast.ASTExpression getRightOperand()
27. net.sourceforge.pmd.lang.java.ast.ASTMethodDeclaration: public net.sourceforge.pmd.lang.java.ast.ASTBlock getBody(), //Returns the body of this method or constructor. Returns null if this is the declaration of an abstract method.

1.  //Check whether the local variable is array type
```java
import net.sourceforge.pmd.lang.java.ast.ASTLocalVariableDeclaration;
import net.sourceforge.pmd.lang.java.ast.ASTType;
public boolean isLocalVariableArrayType(ASTLocalVariableDeclaration node) {
    ASTType type = node.getTypeNode();
    return type.getTypeMirror().isArray();
}
```
2.  //Check whether the field is array type
```java
import net.sourceforge.pmd.lang.java.ast.ASTFieldDeclaration;
import net.sourceforge.pmd.lang.java.ast.ASTType;
public boolean isFieldArrayType(ASTFieldDeclaration node) {
    ASTType type = node.getTypeNode();
    return type.getTypeMirror().isArray();
}
```
3.  //Get the return type of called method
```java
import net.sourceforge.pmd.lang.java.ast.ASTMethodCall;
import net.sourceforge.pmd.lang.java.types.JMethodSig;
import net.sourceforge.pmd.lang.java.types.JTypeMirror;
public JTypeMirror getReturnType(ASTMethodCall call) {
    JMethodSig m = call.getMethodType();
    return m.getReturnType();
}
```
4.  //Check whether the return type of called method is string
```java
import net.sourceforge.pmd.lang.java.ast.ASTMethodCall;
import net.sourceforge.pmd.lang.java.types.JMethodSig;
import net.sourceforge.pmd.lang.java.types.TypeTestUtil;
public boolean isReturnStringType(ASTMethodCall call) {
    JMethodSig m = call.getMethodType();
    return TypeTestUtil.isA(String.class, m.getReturnType());
}
```
5.  //Check whether the argument is array type
```java
import net.sourceforge.pmd.lang.java.ast.ASTMethodCall;
import net.sourceforge.pmd.lang.java.ast.ASTArgumentList;
import net.sourceforge.pmd.lang.java.ast.ASTExpression;
public boolean isMethodCallArgumentArrayType(ASTMethodCall node) {
   ASTArgumentList astArgumentList = node.getArguments();
    //select which argument to judge
    ASTExpression expression = astArgumentList.get(0);
    return expression.getTypeMirror().isArray();
}
```
6.  //Check whether the array is string type
```java
import net.sourceforge.pmd.lang.java.ast.ASTVariableDeclaratorId;
import net.sourceforge.pmd.lang.java.ast.ASTArrayType;
import net.sourceforge.pmd.lang.java.ast.ASTType;
import net.sourceforge.pmd.lang.java.ast.ASTClassOrInterfaceType;
import net.sourceforge.pmd.lang.java.types.TypeTestUtil;
public boolean isArrayStringType(ASTVariableDeclaratorId node) {
    if(node.getType().isArray()){
        ASTArrayType arrayType = (ASTArrayType)node.getTypeNode();
        ASTType astType = (ASTType) arrayType.getChild(0);
        if(astType instanceof ASTClassOrInterfaceType){
            ASTClassOrInterfaceType classOrInterfaceType = (ASTClassOrInterfaceType)astType;
            return TypeTestUtil.isA(String.class, classOrInterfaceType);
        }
    }
    return false;
}
```


Below are some edge-related APIs to help traverse abstract syntax tree, if you need, you can use them:
1. public net.sourceforge.pmd.lang.ast.NodeStream<JavaNode> children()
2. public net.sourceforge.pmd.lang.ast.NodeStream<JavaNode> children(java.lang.Class)
3. public N getChild(int i)
4. public N getFirstChild()
5. public N getLastChild()
6. public N firstChild(java.lang.Class)
7. public int getNumChildren()
8. public int getIndexInParent()
9. public net.sourceforge.pmd.lang.ast.NodeStream.DescendantNodeStream<JavaNode> descendants()
10. public net.sourceforge.pmd.lang.ast.NodeStream.DescendantNodeStream<JavaNode> descendants(java.lang.Class)
11. public net.sourceforge.pmd.lang.ast.NodeStream.DescendantNodeStream<JavaNode> descendantsOrSelf()
12. public N getParent()
13. public N getNthParent(int i)
14. public net.sourceforge.pmd.lang.ast.NodeStream<JavaNode> ancestors()
15. public net.sourceforge.pmd.lang.ast.NodeStream<JavaNode> ancestors(java.lang.Class)
16. public net.sourceforge.pmd.lang.ast.NodeStream<JavaNode> ancestorsOrSelf()
17. public N getPreviousSibling()
18. public N getNextSibling()

Please do not use the following API:


==========5轮中每一轮为第一个测试用例生成的checker===============
package net.sourceforge.pmd.lang.java.rule.performance;


import net.sourceforge.pmd.lang.java.rule.AbstractJavaRulechainRule;
import net.sourceforge.pmd.lang.java.ast. *;
import net.sourceforge.pmd.lang.java.ast.internal. *;
import net.sourceforge.pmd.lang.java.types. *;
import net.sourceforge.pmd.lang.java.symbols. *;
import net.sourceforge.pmd.lang.ast.NodeStream;
public class AvoidInstantiatingObjectsInLoopsRule extends AbstractJavaRulechainRule {

    public AvoidInstantiatingObjectsInLoopsRule() {
        super(ASTForStatement.class, ASTWhileStatement.class, ASTDoStatement.class);
    }

    @Override
    public Object visit(ASTForStatement node, Object data) {
        checkForInstantiations(node, data);
        return super.visit(node, data);
    }

    @Override
    public Object visit(ASTWhileStatement node, Object data) {
        checkForInstantiations(node, data);
        return super.visit(node, data);
    }

    @Override
    public Object visit(ASTDoStatement node, Object data) {
        checkForInstantiations(node, data);
        return super.visit(node, data);
    }

    private void checkForInstantiations(Node node, Object data) {
        for (int i = 0; i < node.jjtGetNumChildren(); i++) {
            Node child = node.jjtGetChild(i);
            if (child instanceof ASTBlock) {
                for (int j = 0; j < child.jjtGetNumChildren(); j++) {
                    Node blockChild = child.jjtGetChild(j);
                    if (blockChild instanceof ASTBlockStatement) {
                        Node potentialAllocation = blockChild.jjtGetChild(0);
                        if (potentialAllocation instanceof ASTAllocationExpression
                                && potentialAllocation.jjtGetChild(0) instanceof ASTArrayDimsAndInits) {
                            addViolation(data, blockChild);
                        }
                    }
                }
            }
        }
    }
}
第一个测试用例生成的checker开始编译
一开始编译是否通过：
False
编译错误不在预期范围内，重新生成
5轮生成失败
结束

规则执行完毕，时间总花销： 1149.2653677463531 秒
